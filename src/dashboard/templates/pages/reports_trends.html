<!-- SSH Guardian v3.0 - Trends Reports Page -->
<div id="page-reports-trends" class="page-content" style="display: none;">
    <div class="page-header-with-cache">
        <div>
            <h1 class="page-title">Security Trends</h1>
            <p class="page-subtitle">Historical analysis and trend visualization</p>
        </div>
        <div class="page-header-actions">
            <div class="cache-indicator loading" data-cache-endpoint="trends">
                <span class="cache-status-dot"></span>
                <span class="cache-indicator-text">Loading...</span>
                <span class="cache-time"></span>
                <button class="cache-refresh-btn" onclick="loadTrendsReportsPage()" title="Refresh data">‚Üª</button>
            </div>
        </div>
    </div>

    <!-- Period Selection -->
    <div class="card" style="padding: 14px; margin-bottom: 20px;">
        <div style="display: flex; gap: 12px; flex-wrap: wrap; align-items: center;">
            <span style="font-weight: 600; font-size: 13px;">Time Period:</span>
            <select id="trends-period-select" style="padding: 8px 12px; border: 1px solid var(--border); border-radius: 4px; font-size: 13px; background: var(--surface);"
                    onchange="onTrendsPeriodChange(this.value)">
                <option value="7">Last 7 days</option>
                <option value="14">Last 14 days</option>
                <option value="30" selected>Last 30 days</option>
                <option value="60">Last 60 days</option>
                <option value="90">Last 90 days</option>
            </select>
            <button onclick="refreshTrends()" style="padding: 8px 16px; background: var(--surface); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; font-size: 13px;">
                üîÑ Refresh
            </button>
            <div style="flex: 1;"></div>
            <span id="trends-risk-totals" style="font-size: 12px; color: var(--text-secondary);"></span>
        </div>
    </div>

    <!-- Summary Stats -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 20px;">
        <div class="card" style="padding: 14px;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 34px; height: 34px; background: linear-gradient(135deg, #0078D4 0%, #005A9E 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0;">üìä</div>
                <div style="min-width: 0;">
                    <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">Total Events</div>
                    <div id="trends-total-events" style="font-size: 20px; font-weight: 700;">-</div>
                    <div id="trends-total-detail" style="font-size: 11px; color: var(--text-secondary);">Loading...</div>
                </div>
            </div>
        </div>

        <div class="card" style="padding: 14px;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 34px; height: 34px; background: linear-gradient(135deg, #D13438 0%, #A52A2A 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0;">‚ùå</div>
                <div style="min-width: 0;">
                    <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">Failed Logins</div>
                    <div id="trends-failed-events" style="font-size: 20px; font-weight: 700; color: #D13438;">-</div>
                    <div id="trends-failed-detail" style="font-size: 11px; color: var(--text-secondary);">Loading...</div>
                </div>
            </div>
        </div>

        <div class="card" style="padding: 14px;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 34px; height: 34px; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0;">‚ö†Ô∏è</div>
                <div style="min-width: 0;">
                    <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">High Risk</div>
                    <div id="trends-high-risk" style="font-size: 20px; font-weight: 700; color: #E6A502;">-</div>
                    <div id="trends-high-risk-detail" style="font-size: 11px; color: var(--text-secondary);">Loading...</div>
                </div>
            </div>
        </div>

        <div class="card" style="padding: 14px;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 34px; height: 34px; background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0;">üìà</div>
                <div style="min-width: 0;">
                    <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">Failure Rate</div>
                    <div id="trends-fail-rate" style="font-size: 20px; font-weight: 700; color: #0078D4;">-</div>
                    <div id="trends-fail-rate-detail" style="font-size: 11px; color: var(--text-secondary);">Loading...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Period Comparison - HIDDEN -->
    <div class="card" style="margin-bottom: 16px; display: none;">
        <div style="padding: 14px; border-bottom: 1px solid var(--border); font-size: 15px; font-weight: 600; color: var(--text-primary);">üìä Period Comparison (vs Previous Period)</div>
        <div id="trends-comparison-container" style="padding: 16px;">
            <div style="text-align: center; padding: 24px; color: var(--text-secondary);">Loading...</div>
        </div>
    </div>

    <!-- Events Timeline Chart -->
    <div class="card" style="margin-bottom: 16px;">
        <div style="padding: 14px; border-bottom: 1px solid var(--border); font-size: 15px; font-weight: 600; color: var(--text-primary);">üìâ Events Timeline</div>
        <div style="padding: 16px; height: 300px;">
            <canvas id="trends-events-chart"></canvas>
        </div>
    </div>

    <!-- Risk Distribution Chart -->
    <div class="card" style="margin-bottom: 16px;">
        <div style="padding: 14px; border-bottom: 1px solid var(--border); font-size: 15px; font-weight: 600; color: var(--text-primary);">üéØ Risk Distribution Over Time</div>
        <div style="padding: 16px; height: 280px;">
            <canvas id="trends-risk-chart"></canvas>
        </div>
    </div>

    <!-- Data Tables Row - HIDDEN -->
    <div style="display: none; grid-template-columns: 1.5fr 1fr; gap: 16px; margin-bottom: 16px;">
        <!-- Top Attackers -->
        <div class="card">
            <div style="padding: 14px; border-bottom: 1px solid var(--border); font-size: 15px; font-weight: 600; color: var(--text-primary);">‚ö†Ô∏è Top Attackers</div>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                    <thead>
                        <tr style="background: var(--background); border-bottom: 2px solid var(--border);">
                            <th style="padding: 10px; text-align: left; font-weight: 600;">#</th>
                            <th style="padding: 10px; text-align: left; font-weight: 600;">IP Address</th>
                            <th style="padding: 10px; text-align: center; font-weight: 600;">Attempts</th>
                            <th style="padding: 10px; text-align: center; font-weight: 600;">Active</th>
                            <th style="padding: 10px; text-align: center; font-weight: 600;">Usernames</th>
                            <th style="padding: 10px; text-align: center; font-weight: 600;">Risk</th>
                        </tr>
                    </thead>
                    <tbody id="trends-attackers-tbody">
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 24px; color: var(--text-secondary);">
                                Loading...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Targeted Usernames -->
        <div class="card">
            <div style="padding: 14px; border-bottom: 1px solid var(--border); font-size: 15px; font-weight: 600; color: var(--text-primary);">üë§ Most Targeted Usernames</div>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                    <thead>
                        <tr style="background: var(--background); border-bottom: 2px solid var(--border);">
                            <th style="padding: 10px; text-align: left; font-weight: 600;">Username</th>
                            <th style="padding: 10px; text-align: center; font-weight: 600;">Attempts</th>
                            <th style="padding: 10px; text-align: center; font-weight: 600;">IPs</th>
                            <th style="padding: 10px; text-align: center; font-weight: 600;">Active</th>
                        </tr>
                    </thead>
                    <tbody id="trends-usernames-tbody">
                        <tr>
                            <td colspan="4" style="text-align: center; padding: 24px; color: var(--text-secondary);">
                                Loading...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Country Analysis Row - HIDDEN -->
    <div style="display: none; grid-template-columns: 1fr 1.2fr; gap: 16px;">
        <!-- Country Chart -->
        <div class="card">
            <div style="padding: 14px; border-bottom: 1px solid var(--border); font-size: 15px; font-weight: 600; color: var(--text-primary);">üåç Attack Sources by Country</div>
            <div style="padding: 16px; height: 260px;">
                <canvas id="trends-country-chart"></canvas>
            </div>
        </div>

        <!-- Country Table -->
        <div class="card">
            <div style="padding: 14px; border-bottom: 1px solid var(--border); font-size: 15px; font-weight: 600; color: var(--text-primary);">üó∫Ô∏è Country Breakdown</div>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                    <thead>
                        <tr style="background: var(--background); border-bottom: 2px solid var(--border);">
                            <th style="padding: 10px; text-align: left; font-weight: 600;">Country</th>
                            <th style="padding: 10px; text-align: center; font-weight: 600;">Attempts</th>
                            <th style="padding: 10px; text-align: center; font-weight: 600;">IPs</th>
                            <th style="padding: 10px; text-align: center; font-weight: 600;">Risk</th>
                        </tr>
                    </thead>
                    <tbody id="trends-country-tbody">
                        <tr>
                            <td colspan="4" style="text-align: center; padding: 24px; color: var(--text-secondary);">
                                Loading...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
