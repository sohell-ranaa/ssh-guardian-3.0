<!-- SSH Guardian v3.0 - Threat Intelligence Page -->
<div id="page-ip-threat" class="page-content" style="display: none;">
    <div class="page-header-with-cache">
        <div>
            <h1 class="page-title">Threat Intelligence</h1>
            <p class="page-subtitle">Real-time threat data from AbuseIPDB, VirusTotal & Shodan</p>
        </div>
        <div class="page-header-actions">
            <div class="cache-indicator loading" data-cache-endpoint="threat_intel">
                <span class="cache-status-dot"></span>
                <span class="cache-indicator-text">Loading...</span>
                <span class="cache-time"></span>
                <button class="cache-refresh-btn" onclick="loadThreatIntelPage()" title="Refresh data">‚Üª</button>
            </div>
        </div>
    </div>

    <!-- Compact Stats -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; margin-bottom: 20px;">
        <div class="card" style="padding: 14px;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 34px; height: 34px; background: linear-gradient(135deg, #0078D4 0%, #005A9E 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0;">üìä</div>
                <div style="min-width: 0;">
                    <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">IPs Tracked</div>
                    <div id="stat-total-threats" style="font-size: 20px; font-weight: 700;">-</div>
                </div>
            </div>
        </div>

        <div class="card" style="padding: 14px;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 34px; height: 34px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0;">‚ö†Ô∏è</div>
                <div style="min-width: 0;">
                    <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">Critical Risk</div>
                    <div id="stat-critical-threat" style="font-size: 20px; font-weight: 700; color: #ef4444;">-</div>
                </div>
            </div>
        </div>

        <div class="card" style="padding: 14px;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 34px; height: 34px; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0;">üî•</div>
                <div style="min-width: 0;">
                    <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">High Risk</div>
                    <div id="stat-high-threat" style="font-size: 20px; font-weight: 700; color: #f59e0b;">-</div>
                </div>
            </div>
        </div>

        <div class="card" style="padding: 14px;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 34px; height: 34px; background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0;">üìà</div>
                <div style="min-width: 0;">
                    <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">Avg Score</div>
                    <div id="stat-avg-score" style="font-size: 20px; font-weight: 700; color: #8b5cf6;">-</div>
                </div>
            </div>
        </div>

        <div class="card" style="padding: 14px;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 34px; height: 34px; background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0;">üìù</div>
                <div style="min-width: 0;">
                    <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 2px;">Total Reports</div>
                    <div id="stat-total-reports" style="font-size: 20px; font-weight: 700; color: #06b6d4;">-</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Threat Lookup -->
    <div class="card" style="margin-bottom: 20px;">
        <div style="padding: 14px; border-bottom: 1px solid var(--border);">
            <h3 style="margin: 0; font-size: 15px; font-weight: 600;">üîç IP Threat Lookup</h3>
        </div>
        <div style="padding: 14px;">
            <div style="display: flex; gap: 8px; margin-bottom: 12px; max-width: 600px;">
                <input
                    type="text"
                    id="threat-search-input"
                    placeholder="Enter IP address to check threat intelligence"
                    style="flex: 1; padding: 10px 14px; border: 1px solid var(--border); border-radius: 4px; font-size: 13px; background: var(--surface);"
                    onkeypress="if(event.key === 'Enter') lookupThreat()"
                >
                <button
                    onclick="lookupThreat()"
                    style="padding: 10px 24px; background: var(--azure-blue); color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 13px; font-weight: 600; white-space: nowrap;"
                >
                    Check Threat
                </button>
            </div>
            <div id="threat-lookup-result"></div>
        </div>
    </div>

    <!-- High Risk IPs Table -->
    <div class="card" style="margin-bottom: 20px;">
        <div style="padding: 14px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between;">
            <h3 style="margin: 0; font-size: 15px; font-weight: 600;">‚ö†Ô∏è Critical & High Risk IPs</h3>
            <button onclick="loadThreatIntelPage()" style="padding: 6px 12px; background: var(--surface); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; font-size: 12px;">
                üîÑ Refresh
            </button>
        </div>
        <div id="threat-high-risk-list" style="padding: 14px;">
            <div style="text-align: center; padding: 20px; color: var(--text-secondary); font-size: 13px;">Loading...</div>
        </div>
    </div>

    <!-- Recent Threat Checks -->
    <div class="card">
        <div style="padding: 14px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between;">
            <h3 style="margin: 0; font-size: 15px; font-weight: 600;">üìã Recent Threat Intelligence Checks</h3>
            <div style="font-size: 12px; color: var(--text-secondary);">Last 20 checks</div>
        </div>
        <div id="threat-recent-list" style="padding: 14px;">
            <div style="text-align: center; padding: 20px; color: var(--text-secondary); font-size: 13px;">Loading...</div>
        </div>
    </div>
</div>
