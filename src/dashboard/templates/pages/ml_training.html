<!-- SSH Guardian v3.0 - ML Training & Data Management Page -->
<div id="page-ml-training" class="page-content" style="display: none;">
    <div class="page-header-with-cache">
        <div>
            <h2 style="margin: 0 0 8px 0; color: var(--text-primary); font-size: 24px; font-weight: 600;">
                ML Training & Data Management
            </h2>
            <p style="margin: 0; color: var(--text-secondary); font-size: 14px;">
                Generate training data, train models, and manage the ML pipeline
            </p>
        </div>
        <div class="page-header-actions">
            <button class="refresh-btn" onclick="refreshTrainingPage()">
                <span class="refresh-icon">â†»</span> Refresh
            </button>
        </div>
    </div>

    <!-- Data Statistics Overview -->
    <div class="training-stats-grid">
        <div class="card stat-card">
            <div class="stat-label">Total Events</div>
            <div class="stat-value stat-blue" id="stats-total-events">-</div>
        </div>
        <div class="card stat-card">
            <div class="stat-label">Failed Events</div>
            <div class="stat-value stat-red" id="stats-failed-events">-</div>
        </div>
        <div class="card stat-card">
            <div class="stat-label">Success Events</div>
            <div class="stat-value stat-green" id="stats-success-events">-</div>
        </div>
        <div class="card stat-card">
            <div class="stat-label">Unique IPs</div>
            <div class="stat-value" id="stats-unique-ips">-</div>
        </div>
        <div class="card stat-card">
            <div class="stat-label">Trained Models</div>
            <div class="stat-value stat-green" id="stats-trained-models">-</div>
        </div>
        <div class="card stat-card">
            <div class="stat-label">Active Model</div>
            <div class="stat-value stat-blue stat-small" id="stats-active-model">-</div>
        </div>
    </div>

    <!-- Main Grid: Simulation & Training Side by Side -->
    <div class="training-main-grid">
        <!-- Generate Training Data Section -->
        <div class="card" style="padding: 20px;">
            <h3 class="section-title">
                <span class="section-icon">ðŸ“Š</span> Generate Training Data
            </h3>

            <div class="form-group">
                <label class="form-label">Attack Template</label>
                <select id="sim-template" class="form-select">
                    <option value="">Loading templates...</option>
                </select>
            </div>

            <div id="sim-template-info" class="template-info" style="display: none;">
                <div class="template-info-label">Description</div>
                <div id="sim-template-desc" class="template-info-desc"></div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Event Count</label>
                    <input type="number" id="sim-event-count" value="50" min="10" max="500" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Delay (ms)</label>
                    <input type="number" id="sim-delay" value="50" min="0" max="1000" class="form-input">
                </div>
            </div>

            <button onclick="runSimulation()" id="run-sim-btn" class="btn btn-warning btn-full">
                Generate Events
            </button>

            <div id="sim-progress" class="progress-container" style="display: none;">
                <div class="progress-header">
                    <span id="sim-status" class="progress-status">Running...</span>
                    <span id="sim-progress-text" class="progress-percent">0%</span>
                </div>
                <div class="progress-track">
                    <div id="sim-progress-bar" class="progress-bar progress-bar-warning"></div>
                </div>
            </div>

            <!-- Quick Generate Buttons -->
            <div class="quick-generate-section">
                <div class="quick-generate-label">Quick Generate (50 events each):</div>
                <div class="quick-generate-buttons">
                    <button onclick="quickGenerate('brute_force', this)" class="quick-gen-btn">Brute Force</button>
                    <button onclick="quickGenerate('distributed_brute_force', this)" class="quick-gen-btn">Distributed</button>
                    <button onclick="quickGenerate('credential_stuffing', this)" class="quick-gen-btn">Credential Stuffing</button>
                    <button onclick="quickGenerate('reconnaissance', this)" class="quick-gen-btn">Recon</button>
                    <button onclick="quickGenerate('slow_brute_force', this)" class="quick-gen-btn">Slow Attack</button>
                </div>
            </div>
        </div>

        <!-- Train Model Section -->
        <div class="card" style="padding: 20px;">
            <h3 class="section-title">
                <span class="section-icon">ðŸ¤–</span> Train New Model
            </h3>

            <div class="form-group">
                <label class="form-label">Algorithm</label>
                <select id="training-algorithm" class="form-select">
                    <option value="random_forest">Random Forest (Recommended)</option>
                    <option value="gradient_boosting">Gradient Boosting</option>
                    <option value="xgboost">XGBoost</option>
                    <option value="all">All Algorithms (Auto-select best)</option>
                </select>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Start Date</label>
                    <input type="date" id="training-start-date" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">End Date</label>
                    <input type="date" id="training-end-date" class="form-input">
                </div>
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="training-include-sim" checked class="checkbox-input">
                    <span>Include simulation data</span>
                </label>
            </div>

            <!-- Train/Test Split Info -->
            <div class="info-box info-box-blue">
                <span class="info-icon">ðŸ“ˆ</span>
                <div>
                    <div class="info-title">Train/Test Split: 80% / 20%</div>
                    <div class="info-desc">Standard ML practice for balanced training</div>
                </div>
            </div>

            <button onclick="startTraining()" id="start-training-btn" class="btn btn-success btn-full">
                Start Training
            </button>

            <div id="training-progress" class="progress-container" style="display: none;">
                <div class="progress-header">
                    <span id="training-stage" class="progress-status">Initializing...</span>
                    <span id="training-progress-percent" class="progress-percent">0%</span>
                </div>
                <div class="progress-track">
                    <div id="training-progress-bar" class="progress-bar progress-bar-success"></div>
                </div>
                <div id="training-message" class="progress-message"></div>
            </div>

            <!-- Minimum Data Warning -->
            <div id="min-data-warning" class="warning-box" style="display: none;">
                <div class="warning-title">Not enough training data</div>
                <div class="warning-desc">Minimum 100 events required. Generate more data using the simulation panel.</div>
            </div>
        </div>
    </div>

    <!-- Model Management Section -->
    <div class="card" style="padding: 20px; margin-bottom: 24px;">
        <h3 class="section-title">
            <span class="section-icon">ðŸ“¦</span> Trained Models
        </h3>
        <div id="models-container">
            <div class="loading-placeholder">Loading models...</div>
        </div>
    </div>

    <!-- Training History -->
    <div class="card" style="padding: 20px;">
        <h3 class="section-title">Training History</h3>
        <div class="table-wrapper">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Run ID</th>
                        <th>Algorithm</th>
                        <th class="text-center">Samples (Train/Test)</th>
                        <th class="text-center">Status</th>
                        <th class="text-center">Duration</th>
                        <th class="text-center">F1 Score</th>
                        <th>Started</th>
                    </tr>
                </thead>
                <tbody id="training-history-body">
                    <tr>
                        <td colspan="7" class="loading-placeholder">Loading...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>


<!-- External CSS - Loaded via dashboard_modular.html -->
<!-- /static/css/pages/ml_training.css -->

<!-- External JS - Loaded via dashboard_modular.html -->
<!-- /static/js/modules/ml_training.js -->
