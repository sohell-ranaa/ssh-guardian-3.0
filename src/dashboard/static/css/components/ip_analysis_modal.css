/* SSH Guardian v3.0 - IP Analysis Modal */
/* Professional tabbed design with ML reasoning integration */

/* ====== Overlay & Modal Container ====== */
.ip-analysis-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px);
    z-index: 3000;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.2s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.ip-analysis-modal {
    background: var(--surface);
    border-radius: 12px;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    width: 95%;
    max-width: 900px;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    animation: slideUp 0.3s ease;
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* ====== Header ====== */
.ip-analysis-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    border-bottom: 1px solid var(--border);
    background: var(--surface);
}

.ip-analysis-header-left {
    display: flex;
    align-items: center;
    gap: 14px;
}

.ip-analysis-icon {
    width: 44px;
    height: 44px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.ip-analysis-icon.critical { background: linear-gradient(135deg, var(--color-danger-dark) 0%, var(--color-orange-dark) 100%); }
.ip-analysis-icon.high { background: linear-gradient(135deg, var(--color-orange-dark) 0%, var(--color-orange) 100%); }
.ip-analysis-icon.moderate { background: linear-gradient(135deg, var(--color-orange) 0%, var(--color-gold) 100%); }
.ip-analysis-icon.low { background: linear-gradient(135deg, var(--color-gold) 0%, var(--color-success-dark) 100%); }
.ip-analysis-icon.clean { background: linear-gradient(135deg, var(--color-success-dark) 0%, var(--color-success-light) 100%); }
.ip-analysis-icon.unknown { background: linear-gradient(135deg, var(--text-secondary) 0%, var(--text-tertiary) 100%); }

.ip-analysis-title-group h2 {
    font-size: 17px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0 0 3px 0;
    font-family: 'SF Mono', 'Monaco', monospace;
}

.ip-analysis-location {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: var(--text-secondary);
}

.ip-analysis-location img { border-radius: 2px; }
.isp-name { color: var(--text-hint); }

.header-actions {
    display: flex;
    align-items: center;
    gap: 12px;
}

.quick-score {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 8px 14px;
    border-radius: 8px;
    min-width: 60px;
}

.quick-score.critical { background: rgba(168, 0, 0, 0.1); }
.quick-score.high { background: rgba(216, 59, 1, 0.1); }
.quick-score.moderate { background: rgba(255, 140, 0, 0.1); }
.quick-score.low { background: rgba(255, 185, 0, 0.1); }
.quick-score.clean { background: rgba(16, 124, 16, 0.1); }
.quick-score.unknown { background: var(--background); }

.quick-score .score-value {
    font-size: 22px;
    font-weight: 700;
    line-height: 1;
}

.quick-score.critical .score-value { color: var(--color-danger-dark); }
.quick-score.high .score-value { color: var(--color-orange-dark); }
.quick-score.moderate .score-value { color: var(--color-orange); }
.quick-score.low .score-value { color: var(--color-warning-dark); }
.quick-score.clean .score-value { color: var(--color-success-dark); }
.quick-score.unknown .score-value { color: var(--text-secondary); }

.quick-score .score-label {
    font-size: 9px;
    font-weight: 600;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-top: 2px;
}

.ip-analysis-close {
    width: 32px;
    height: 32px;
    border: none;
    background: transparent;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    font-size: 22px;
    color: var(--text-secondary);
    transition: all 0.15s;
}

.ip-analysis-close:hover {
    background: var(--background);
    color: var(--text-primary);
}

/* ====== Tabs ====== */
.analysis-tabs {
    display: flex;
    gap: 2px;
    padding: 0 16px;
    background: var(--background);
    border-bottom: 1px solid var(--border);
    overflow-x: auto;
}

.analysis-tab {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 12px 16px;
    border: none;
    background: transparent;
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
    border-bottom: 2px solid transparent;
    transition: all 0.15s;
    white-space: nowrap;
}

.analysis-tab:hover {
    color: var(--text-primary);
    background: var(--surface);
}

.analysis-tab.active {
    color: var(--azure-blue);
    border-bottom-color: var(--azure-blue);
    background: var(--surface);
}

.tab-icon { font-size: 14px; }

/* ====== Body & Tab Content ====== */
.ip-analysis-body {
    padding: 20px;
    overflow-y: auto;
    flex: 1;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
    animation: fadeIn 0.2s ease;
}

/* ====== Overview Hero ====== */
.overview-hero {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
    position: relative;
}

.overview-hero.critical { background: linear-gradient(135deg, rgba(168, 0, 0, 0.08) 0%, rgba(216, 59, 1, 0.04) 100%); border: 1px solid rgba(168, 0, 0, 0.15); }
.overview-hero.high { background: linear-gradient(135deg, rgba(216, 59, 1, 0.08) 0%, rgba(255, 140, 0, 0.04) 100%); border: 1px solid rgba(216, 59, 1, 0.15); }
.overview-hero.moderate { background: linear-gradient(135deg, rgba(255, 140, 0, 0.08) 0%, rgba(255, 185, 0, 0.04) 100%); border: 1px solid rgba(255, 140, 0, 0.15); }
.overview-hero.low { background: linear-gradient(135deg, rgba(255, 185, 0, 0.08) 0%, rgba(16, 124, 16, 0.04) 100%); border: 1px solid rgba(255, 185, 0, 0.15); }
.overview-hero.clean { background: linear-gradient(135deg, rgba(16, 124, 16, 0.08) 0%, rgba(16, 185, 129, 0.04) 100%); border: 1px solid rgba(16, 124, 16, 0.15); }
.overview-hero.unknown { background: var(--background); border: 1px solid var(--border); }

.hero-left { flex: 1; }

.hero-title {
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 6px;
}

.hero-description {
    font-size: 14px;
    color: var(--text-primary);
    line-height: 1.5;
    max-width: 380px;
}

.hero-right { text-align: center; }

.score-circle {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: var(--surface);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    border: 3px solid;
}

.score-circle.critical { border-color: var(--color-danger-dark); }
.score-circle.high { border-color: var(--color-orange-dark); }
.score-circle.moderate { border-color: var(--color-orange); }
.score-circle.low { border-color: var(--color-gold); }
.score-circle.clean { border-color: var(--color-success-dark); }
.score-circle.unknown { border-color: var(--text-secondary); }

.score-number {
    font-size: 28px;
    font-weight: 700;
    line-height: 1;
}

.score-circle.critical .score-number { color: var(--color-danger-dark); }
.score-circle.high .score-number { color: var(--color-orange-dark); }
.score-circle.moderate .score-number { color: var(--color-orange); }
.score-circle.low .score-number { color: var(--color-warning-dark); }
.score-circle.clean .score-number { color: var(--color-success-dark); }
.score-circle.unknown .score-number { color: var(--text-secondary); }

.score-level {
    font-size: 9px;
    font-weight: 600;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-top: 2px;
}

.confidence-text {
    font-size: 11px;
    color: var(--text-secondary);
    margin-top: 8px;
}

/* Network Flags */
.network-flags {
    display: flex;
    gap: 6px;
    margin-top: 12px;
    flex-wrap: wrap;
}

.network-flag {
    padding: 4px 10px;
    border-radius: 4px;
    font-size: 10px;
    font-weight: 600;
    color: white;
}

.network-flag.tor { background: var(--color-purple); }
.network-flag.vpn { background: var(--azure-blue); }
.network-flag.proxy { background: var(--color-warning); }
.network-flag.datacenter { background: var(--text-secondary); }

/* ====== Section Card ====== */
.section-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
    margin-bottom: 16px;
}

.section-card:last-child { margin-bottom: 0; }

.section-card.subtle {
    background: var(--background);
    border: none;
}

.section-header-row {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 14px;
}

.section-header-row h3 {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
    flex: 1;
}

.section-icon {
    width: 26px;
    height: 26px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    color: white;
}

.section-icon.blue { background: var(--azure-blue); }
.section-icon.green { background: var(--color-success-dark); }
.section-icon.orange { background: var(--color-orange); }
.section-icon.purple { background: var(--color-purple); }
.section-icon.gray { background: var(--text-secondary); }

.factor-count {
    font-size: 11px;
    color: var(--text-hint);
    background: var(--background);
    padding: 3px 8px;
    border-radius: 10px;
}

/* ====== Breakdown Grid ====== */
.breakdown-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.breakdown-card {
    background: var(--background);
    border-radius: 8px;
    padding: 14px;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.breakdown-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
}

.breakdown-card.threat-intel::before { background: linear-gradient(90deg, var(--color-orange-dark), var(--color-orange)); }
.breakdown-card.ml::before { background: linear-gradient(90deg, var(--azure-blue), var(--color-teal)); }
.breakdown-card.behavioral::before { background: linear-gradient(90deg, var(--color-orange), var(--color-gold)); }
.breakdown-card.geographic::before { background: linear-gradient(90deg, var(--color-purple), var(--color-purple)); }

.breakdown-score {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 2px;
}

.breakdown-card.threat-intel .breakdown-score { color: var(--color-orange-dark); }
.breakdown-card.ml .breakdown-score { color: var(--azure-blue); }
.breakdown-card.behavioral .breakdown-score { color: var(--color-orange); }
.breakdown-card.geographic .breakdown-score { color: var(--color-purple); }

.breakdown-label {
    font-size: 11px;
    color: var(--text-secondary);
    font-weight: 500;
}

.breakdown-weight {
    font-size: 9px;
    color: var(--text-hint);
    margin-top: 3px;
}

.breakdown-bar {
    height: 3px;
    background: var(--border);
    border-radius: 2px;
    margin-top: 8px;
    overflow: hidden;
}

.breakdown-bar-fill {
    height: 100%;
    background: var(--azure-blue);
    border-radius: 2px;
    transition: width 0.3s;
}

.breakdown-card.threat-intel .breakdown-bar-fill { background: var(--color-orange-dark); }
.breakdown-card.ml .breakdown-bar-fill { background: var(--azure-blue); }
.breakdown-card.behavioral .breakdown-bar-fill { background: var(--color-orange); }
.breakdown-card.geographic .breakdown-bar-fill { background: var(--color-purple); }

/* ====== Stats Row ====== */
.stats-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.stat-box {
    background: var(--background);
    border-radius: 8px;
    padding: 14px;
    text-align: center;
}

.stat-value {
    font-size: 22px;
    font-weight: 700;
    color: var(--text-primary);
}

.stat-value.danger { color: var(--color-orange-dark); }
.stat-value.success { color: var(--color-success-dark); }
.stat-value.warning { color: var(--color-orange); }
.stat-value.info { color: var(--azure-blue); }

.stat-label {
    font-size: 11px;
    color: var(--text-secondary);
    margin-top: 4px;
}

/* ====== ML Analysis Tab ====== */
.ml-hero {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px;
    background: linear-gradient(135deg, rgba(0, 120, 212, 0.08) 0%, rgba(135, 100, 184, 0.08) 100%);
    border: 1px solid rgba(0, 120, 212, 0.15);
    border-radius: 10px;
    margin-bottom: 16px;
}

.ml-score-display {
    display: flex;
    align-items: center;
    gap: 16px;
}

.ml-circle {
    width: 72px;
    height: 72px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--surface);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    border: 3px solid;
}

.ml-circle.danger { border-color: var(--color-orange-dark); }
.ml-circle.warning { border-color: var(--color-orange); }
.ml-circle.moderate { border-color: var(--color-gold); }
.ml-circle.safe { border-color: var(--color-success-dark); }

.ml-score-value {
    font-size: 26px;
    font-weight: 700;
}

.ml-circle.danger .ml-score-value { color: var(--color-orange-dark); }
.ml-circle.warning .ml-score-value { color: var(--color-orange); }
.ml-circle.moderate .ml-score-value { color: var(--color-warning-dark); }
.ml-circle.safe .ml-score-value { color: var(--color-success-dark); }

.ml-score-meta { text-align: left; }

.ml-score-label {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
}

.ml-confidence {
    font-size: 11px;
    color: var(--text-secondary);
    margin-top: 2px;
}

.ml-classification { text-align: right; }

.classification-label {
    font-size: 10px;
    color: var(--text-secondary);
    text-transform: uppercase;
    margin-bottom: 4px;
}

.classification-value {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
}

.anomaly-badge {
    display: inline-block;
    padding: 4px 10px;
    background: var(--color-orange-dark);
    color: white;
    border-radius: 4px;
    font-size: 9px;
    font-weight: 600;
    margin-top: 6px;
}

/* ML Factors */
.ml-factors-container {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.ml-factor-row {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    padding: 12px;
    background: var(--background);
    border-radius: 8px;
    gap: 12px;
}

.factor-info {
    display: flex;
    gap: 10px;
    flex: 1;
}

.factor-icon {
    font-size: 18px;
    flex-shrink: 0;
}

.factor-details { flex: 1; }

.factor-title {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 2px;
}

.factor-description {
    font-size: 12px;
    color: var(--text-secondary);
    line-height: 1.4;
}

.factor-score {
    font-size: 13px;
    font-weight: 700;
    padding: 4px 10px;
    border-radius: 12px;
    flex-shrink: 0;
}

.factor-score.danger { background: rgba(216, 59, 1, 0.1); color: var(--color-orange-dark); }
.factor-score.warning { background: rgba(255, 140, 0, 0.1); color: var(--color-orange); }
.factor-score.moderate { background: rgba(255, 185, 0, 0.1); color: var(--color-warning-dark); }
.factor-score.safe { background: rgba(16, 124, 16, 0.1); color: var(--color-success-dark); }

.empty-state {
    text-align: center;
    padding: 24px;
    color: var(--text-secondary);
}

.empty-state .empty-icon {
    font-size: 24px;
    display: block;
    margin-bottom: 8px;
    color: var(--color-success-dark);
}

/* Indicators */
.indicators-grid, .indicators-container {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.indicator-chip, .indicator-tag {
    padding: 5px 12px;
    background: rgba(255, 140, 0, 0.1);
    color: var(--color-warning);
    border-radius: 16px;
    font-size: 11px;
    font-weight: 500;
}

.indicator-tag.clean {
    background: rgba(16, 124, 16, 0.1);
    color: var(--color-success-dark);
}

/* Model Info */
.model-info {
    display: flex;
    gap: 20px;
    font-size: 11px;
    color: var(--text-hint);
    justify-content: center;
}

/* ====== Threat Intel Tab ====== */
.intel-card-large {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    margin-bottom: 12px;
    overflow: hidden;
}

.intel-header {
    display: flex;
    align-items: center;
    gap: 14px;
    padding: 14px 16px;
    border-bottom: 1px solid var(--border);
}

.intel-logo {
    width: 38px;
    height: 38px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 11px;
    color: white;
    flex-shrink: 0;
}

.intel-logo.abuseipdb { background: linear-gradient(135deg, var(--color-orange-dark), var(--color-orange)); }
.intel-logo.virustotal { background: linear-gradient(135deg, var(--azure-blue), var(--color-teal)); }
.intel-logo.shodan { background: linear-gradient(135deg, var(--color-danger-dark), var(--color-danger)); }

.intel-title { flex: 1; }

.intel-title h4 {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0 0 2px 0;
}

.intel-subtitle {
    font-size: 11px;
    color: var(--text-secondary);
}

.intel-score-large {
    font-size: 24px;
    font-weight: 700;
}

.intel-score-large span {
    font-size: 14px;
    color: var(--text-secondary);
}

.intel-score-large.danger { color: var(--color-orange-dark); }
.intel-score-large.warning { color: var(--color-orange); }
.intel-score-large.safe { color: var(--color-success-dark); }

.intel-body {
    padding: 14px 16px;
    background: var(--background);
}

.intel-stat {
    display: flex;
    align-items: baseline;
    gap: 8px;
    margin-bottom: 12px;
}

.intel-stat-value {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
}

.intel-stat-label {
    font-size: 12px;
    color: var(--text-secondary);
}

.intel-bar-container { margin-top: 8px; }

.intel-bar {
    height: 6px;
    background: var(--border);
    border-radius: 3px;
    overflow: hidden;
}

.intel-bar-fill {
    height: 100%;
    border-radius: 3px;
    transition: width 0.3s;
}

.intel-bar-fill.danger { background: var(--color-orange-dark); }
.intel-bar-fill.warning { background: var(--color-orange); }
.intel-bar-fill.safe { background: var(--color-success-dark); }

.intel-bar-labels {
    display: flex;
    justify-content: space-between;
    font-size: 10px;
    color: var(--text-hint);
    margin-top: 4px;
}

/* Shodan */
.shodan-section {
    margin-bottom: 12px;
}

.shodan-section:last-child { margin-bottom: 0; }

.shodan-label {
    font-size: 11px;
    color: var(--text-secondary);
    margin-bottom: 6px;
    font-weight: 500;
}

.shodan-label.danger { color: var(--color-orange-dark); }

.shodan-ports, .shodan-vulns {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
}

.port-chip {
    padding: 3px 8px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 4px;
    font-size: 11px;
    font-family: monospace;
}

.port-more {
    padding: 3px 8px;
    color: var(--text-secondary);
    font-size: 11px;
}

.vuln-chip {
    padding: 3px 8px;
    background: rgba(216, 59, 1, 0.1);
    color: var(--color-orange-dark);
    border-radius: 4px;
    font-size: 10px;
    font-weight: 500;
}

/* Network Grid */
.network-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
}

.network-item {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.network-label {
    font-size: 11px;
    color: var(--text-secondary);
}

.network-value {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-primary);
}

/* ====== Behavioral Tab ====== */
.behavioral-hero {
    background: linear-gradient(135deg, rgba(255, 140, 0, 0.08) 0%, rgba(255, 185, 0, 0.08) 100%);
    border: 1px solid rgba(255, 140, 0, 0.15);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 16px;
}

.pattern-display {
    display: flex;
    align-items: center;
    gap: 14px;
}

.pattern-icon {
    font-size: 32px;
}

.pattern-label {
    font-size: 11px;
    color: var(--text-secondary);
    text-transform: uppercase;
    margin-bottom: 4px;
}

.pattern-value {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-primary);
}

.metrics-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.metric-card {
    background: var(--background);
    border-radius: 8px;
    padding: 14px;
    text-align: center;
}

.metric-value {
    font-size: 22px;
    font-weight: 700;
    color: var(--text-primary);
}

.metric-value.danger { color: var(--color-orange-dark); }
.metric-value.warning { color: var(--color-orange); }
.metric-value.safe { color: var(--color-success-dark); }
.metric-value.info { color: var(--azure-blue); }

.metric-label {
    font-size: 12px;
    font-weight: 500;
    color: var(--text-primary);
    margin-top: 4px;
}

.metric-sublabel {
    font-size: 10px;
    color: var(--text-hint);
    margin-top: 2px;
}

/* Timeline */
.timeline-row {
    display: flex;
    gap: 24px;
}

.timeline-item {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.timeline-label {
    font-size: 11px;
    color: var(--text-secondary);
}

.timeline-value {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-primary);
}

/* ====== Recommendations Tab ====== */
.recommendations-intro {
    font-size: 13px;
    color: var(--text-secondary);
    margin-bottom: 16px;
    padding: 12px;
    background: var(--background);
    border-radius: 8px;
}

.recommendations-count {
    font-size: 18px;
    font-weight: 700;
    color: var(--azure-blue);
    margin-right: 6px;
}

.recommendations-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 20px;
}

.recommendation-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
    border-left: 4px solid;
    transition: box-shadow 0.2s;
}

.recommendation-card:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.recommendation-card.critical { border-left-color: var(--color-danger-dark); }
.recommendation-card.high { border-left-color: var(--color-orange-dark); }
.recommendation-card.medium { border-left-color: var(--color-orange); }
.recommendation-card.low { border-left-color: var(--color-success-dark); }

.rec-header {
    display: flex;
    align-items: flex-start;
    gap: 12px;
}

.rec-number {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: var(--background);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary);
    flex-shrink: 0;
}

.rec-title-group { flex: 1; }

.rec-action {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 4px;
}

.rec-reason {
    font-size: 12px;
    color: var(--text-secondary);
    line-height: 1.4;
}

.rec-meta {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 4px;
    flex-shrink: 0;
}

.rec-priority {
    padding: 3px 8px;
    border-radius: 4px;
    font-size: 9px;
    font-weight: 600;
    color: white;
    text-transform: uppercase;
}

.rec-priority.critical { background: var(--color-danger-dark); }
.rec-priority.high { background: var(--color-orange-dark); }
.rec-priority.medium { background: var(--color-orange); }
.rec-priority.low { background: var(--color-success-dark); }

.rec-confidence {
    font-size: 11px;
    color: var(--text-hint);
}

.rec-evidence {
    margin-top: 12px;
    padding: 10px 12px;
    background: var(--background);
    border-radius: 6px;
    font-size: 12px;
    color: var(--text-secondary);
}

.evidence-item {
    margin-bottom: 4px;
    line-height: 1.4;
}

.evidence-item:last-child { margin-bottom: 0; }

.rec-risk {
    margin-top: 10px;
    padding: 10px 12px;
    background: rgba(168, 0, 0, 0.06);
    border-radius: 6px;
    font-size: 12px;
    color: var(--color-danger-dark);
    line-height: 1.4;
}

/* Quick Actions */
.quick-actions {
    display: flex;
    gap: 10px;
    padding-top: 16px;
    border-top: 1px solid var(--border);
}

.quick-action-btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 12px 16px;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s;
    border: 1px solid;
}

.quick-action-btn.danger {
    background: rgba(216, 59, 1, 0.1);
    border-color: rgba(216, 59, 1, 0.2);
    color: var(--color-orange-dark);
}

.quick-action-btn.danger:hover {
    background: var(--color-orange-dark);
    color: white;
}

.quick-action-btn.warning {
    background: rgba(255, 140, 0, 0.1);
    border-color: rgba(255, 140, 0, 0.2);
    color: var(--color-orange);
}

.quick-action-btn.warning:hover {
    background: var(--color-orange);
    color: white;
}

.quick-action-btn.success {
    background: rgba(16, 124, 16, 0.1);
    border-color: rgba(16, 124, 16, 0.2);
    color: var(--color-success-dark);
}

.quick-action-btn.success:hover {
    background: var(--color-success-dark);
    color: white;
}

/* Empty Recommendations */
.empty-recommendations {
    text-align: center;
    padding: 48px 24px;
}

.empty-recommendations .empty-icon {
    font-size: 48px;
    color: var(--color-success-dark);
    margin-bottom: 12px;
}

.empty-recommendations .empty-title {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 6px;
}

.empty-recommendations .empty-subtitle {
    font-size: 13px;
    color: var(--text-secondary);
}

/* ====== Responsive ====== */
@media (max-width: 768px) {
    .ip-analysis-modal {
        width: 100%;
        max-height: 100vh;
        border-radius: 0;
    }

    .analysis-tabs { padding: 0 8px; }
    .analysis-tab { padding: 10px 12px; font-size: 12px; }
    .tab-icon { display: none; }

    .breakdown-grid,
    .stats-row,
    .metrics-grid {
        grid-template-columns: repeat(2, 1fr);
    }

    .network-grid { grid-template-columns: 1fr; }

    .overview-hero,
    .ml-hero,
    .behavioral-hero {
        flex-direction: column;
        gap: 16px;
        text-align: center;
    }

    .hero-description { max-width: 100%; }
    .ml-score-display { flex-direction: column; }
    .ml-classification { text-align: center; }

    .quick-actions { flex-direction: column; }

    .rec-header { flex-wrap: wrap; }
    .rec-meta { flex-direction: row; margin-top: 8px; width: 100%; }

    .timeline-row { flex-direction: column; gap: 12px; }
}
