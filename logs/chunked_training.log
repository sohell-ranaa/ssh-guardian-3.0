2025-12-07 03:14:10,868 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-07 03:14:10.868166
2025-12-07 03:14:12,446 [INFO] ======================================================================
2025-12-07 03:14:12,446 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-07 03:14:12,446 [INFO] ======================================================================
2025-12-07 03:14:16,925 [INFO] Total events in range: 2,052,494
2025-12-07 03:14:16,925 [INFO] Processing 42 chunks of 50,000 events each...
2025-12-07 03:14:16,925 [INFO] [Chunk 1/42] Loading events 0 to 50,000...
2025-12-07 03:14:16,928 [ERROR] Training failed: 1054 (42S22): Unknown column 'g.is_high_risk_country' in 'field list'
2025-12-07 03:15:29,802 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-07 03:15:29.802485
2025-12-07 03:15:31,106 [INFO] ======================================================================
2025-12-07 03:15:31,106 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-07 03:15:31,106 [INFO] ======================================================================
2025-12-07 03:15:35,090 [INFO] Total events in range: 2,052,494
2025-12-07 03:15:35,090 [INFO] Processing 42 chunks of 50,000 events each...
2025-12-07 03:15:35,091 [INFO] [Chunk 1/42] Loading events 0 to 50,000...
2025-12-07 03:15:40,773 [INFO] [Chunk 1/42] Processed. Total samples: 50,000
2025-12-07 03:15:40,773 [INFO] [Chunk 2/42] Loading events 50,000 to 100,000...
2025-12-07 03:15:46,031 [INFO] [Chunk 2/42] Processed. Total samples: 100,000
2025-12-07 03:15:46,032 [INFO] [Chunk 3/42] Loading events 100,000 to 150,000...
2025-12-07 03:15:52,139 [INFO] [Chunk 3/42] Processed. Total samples: 150,000
2025-12-07 03:15:52,139 [INFO] [Chunk 4/42] Loading events 150,000 to 200,000...
2025-12-07 03:15:59,430 [INFO] [Chunk 4/42] Processed. Total samples: 200,000
2025-12-07 03:15:59,430 [INFO] [Chunk 5/42] Loading events 200,000 to 250,000...
2025-12-07 03:16:08,144 [INFO] [Chunk 5/42] Processed. Total samples: 250,000
2025-12-07 03:16:08,145 [INFO] [Chunk 6/42] Loading events 250,000 to 300,000...
2025-12-07 03:16:18,415 [INFO] [Chunk 6/42] Processed. Total samples: 300,000
2025-12-07 03:16:18,416 [INFO] [Chunk 7/42] Loading events 300,000 to 350,000...
2025-12-07 03:16:30,449 [INFO] [Chunk 7/42] Processed. Total samples: 350,000
2025-12-07 03:16:30,450 [INFO] [Chunk 8/42] Loading events 350,000 to 400,000...
2025-12-07 03:16:44,154 [INFO] [Chunk 8/42] Processed. Total samples: 400,000
2025-12-07 03:16:44,154 [INFO] [Chunk 9/42] Loading events 400,000 to 450,000...
2025-12-07 03:16:58,873 [INFO] [Chunk 9/42] Processed. Total samples: 450,000
2025-12-07 03:16:58,874 [INFO] [Chunk 10/42] Loading events 450,000 to 500,000...
2025-12-07 03:17:17,952 [INFO] [Chunk 10/42] Processed. Total samples: 500,000
2025-12-07 03:17:17,953 [INFO] [Chunk 11/42] Loading events 500,000 to 550,000...
2025-12-07 03:17:36,506 [INFO] [Chunk 11/42] Processed. Total samples: 550,000
2025-12-07 03:17:36,506 [INFO] [Chunk 12/42] Loading events 550,000 to 600,000...
2025-12-07 03:17:57,027 [INFO] [Chunk 12/42] Processed. Total samples: 600,000
2025-12-07 03:17:57,028 [INFO] [Chunk 13/42] Loading events 600,000 to 650,000...
2025-12-07 03:18:18,668 [INFO] [Chunk 13/42] Processed. Total samples: 650,000
2025-12-07 03:18:18,668 [INFO] [Chunk 14/42] Loading events 650,000 to 700,000...
2025-12-07 03:18:39,859 [INFO] [Chunk 14/42] Processed. Total samples: 700,000
2025-12-07 03:18:39,860 [INFO] [Chunk 15/42] Loading events 700,000 to 750,000...
2025-12-07 03:19:04,224 [INFO] [Chunk 15/42] Processed. Total samples: 750,000
2025-12-07 03:19:04,224 [INFO] [Chunk 16/42] Loading events 750,000 to 800,000...
2025-12-07 03:19:28,167 [INFO] [Chunk 16/42] Processed. Total samples: 800,000
2025-12-07 03:19:28,168 [INFO] [Chunk 17/42] Loading events 800,000 to 850,000...
2025-12-07 03:19:52,385 [INFO] [Chunk 17/42] Processed. Total samples: 850,000
2025-12-07 03:19:52,385 [INFO] [Chunk 18/42] Loading events 850,000 to 900,000...
2025-12-07 03:20:20,442 [INFO] [Chunk 18/42] Processed. Total samples: 900,000
2025-12-07 03:20:20,442 [INFO] [Chunk 19/42] Loading events 900,000 to 950,000...
2025-12-07 03:20:50,793 [INFO] [Chunk 19/42] Processed. Total samples: 950,000
2025-12-07 03:20:50,793 [INFO] [Chunk 20/42] Loading events 950,000 to 1,000,000...
2025-12-07 03:21:21,776 [INFO] [Chunk 20/42] Processed. Total samples: 1,000,000
2025-12-07 03:21:21,776 [INFO] [Chunk 21/42] Loading events 1,000,000 to 1,050,000...
2025-12-07 03:21:53,921 [INFO] [Chunk 21/42] Processed. Total samples: 1,050,000
2025-12-07 03:21:53,922 [INFO] [Chunk 22/42] Loading events 1,050,000 to 1,100,000...
2025-12-07 03:22:27,512 [INFO] [Chunk 22/42] Processed. Total samples: 1,100,000
2025-12-07 03:22:27,513 [INFO] [Chunk 23/42] Loading events 1,100,000 to 1,150,000...
2025-12-07 03:23:04,422 [INFO] [Chunk 23/42] Processed. Total samples: 1,150,000
2025-12-07 03:23:04,422 [INFO] [Chunk 24/42] Loading events 1,150,000 to 1,200,000...
2025-12-07 03:23:40,538 [INFO] [Chunk 24/42] Processed. Total samples: 1,200,000
2025-12-07 03:23:40,539 [INFO] [Chunk 25/42] Loading events 1,200,000 to 1,250,000...
2025-12-07 03:24:21,151 [INFO] [Chunk 25/42] Processed. Total samples: 1,250,000
2025-12-07 03:24:21,151 [INFO] [Chunk 26/42] Loading events 1,250,000 to 1,300,000...
2025-12-07 03:25:01,667 [INFO] [Chunk 26/42] Processed. Total samples: 1,300,000
2025-12-07 03:25:01,668 [INFO] [Chunk 27/42] Loading events 1,300,000 to 1,350,000...
2025-12-07 03:25:45,358 [INFO] [Chunk 27/42] Processed. Total samples: 1,350,000
2025-12-07 03:25:45,359 [INFO] [Chunk 28/42] Loading events 1,350,000 to 1,400,000...
2025-12-07 03:26:29,753 [INFO] [Chunk 28/42] Processed. Total samples: 1,400,000
2025-12-07 03:26:29,753 [INFO] [Chunk 29/42] Loading events 1,400,000 to 1,450,000...
2025-12-07 03:27:14,399 [INFO] [Chunk 29/42] Processed. Total samples: 1,450,000
2025-12-07 03:27:14,399 [INFO] [Chunk 30/42] Loading events 1,450,000 to 1,500,000...
2025-12-07 03:27:58,736 [INFO] [Chunk 30/42] Processed. Total samples: 1,500,000
2025-12-07 03:27:58,736 [INFO] [Chunk 31/42] Loading events 1,500,000 to 1,550,000...
2025-12-07 03:28:47,090 [INFO] [Chunk 31/42] Processed. Total samples: 1,550,000
2025-12-07 03:28:47,091 [INFO] [Chunk 32/42] Loading events 1,550,000 to 1,600,000...
2025-12-07 03:29:36,780 [INFO] [Chunk 32/42] Processed. Total samples: 1,600,000
2025-12-07 03:29:36,780 [INFO] [Chunk 33/42] Loading events 1,600,000 to 1,650,000...
2025-12-07 03:30:29,409 [INFO] [Chunk 33/42] Processed. Total samples: 1,650,000
2025-12-07 03:30:29,409 [INFO] [Chunk 34/42] Loading events 1,650,000 to 1,700,000...
2025-12-07 03:31:22,082 [INFO] [Chunk 34/42] Processed. Total samples: 1,700,000
2025-12-07 03:31:22,082 [INFO] [Chunk 35/42] Loading events 1,700,000 to 1,750,000...
2025-12-07 03:32:15,428 [INFO] [Chunk 35/42] Processed. Total samples: 1,750,000
2025-12-07 03:32:15,429 [INFO] [Chunk 36/42] Loading events 1,750,000 to 1,800,000...
2025-12-07 03:33:09,260 [INFO] [Chunk 36/42] Processed. Total samples: 1,800,000
2025-12-07 03:33:09,260 [INFO] [Chunk 37/42] Loading events 1,800,000 to 1,850,000...
2025-12-07 03:34:06,894 [INFO] [Chunk 37/42] Processed. Total samples: 1,850,000
2025-12-07 03:34:06,895 [INFO] [Chunk 38/42] Loading events 1,850,000 to 1,900,000...
2025-12-07 03:35:07,785 [INFO] [Chunk 38/42] Processed. Total samples: 1,900,000
2025-12-07 03:35:07,785 [INFO] [Chunk 39/42] Loading events 1,900,000 to 1,950,000...
2025-12-07 03:36:08,976 [INFO] [Chunk 39/42] Processed. Total samples: 1,950,000
2025-12-07 03:36:08,976 [INFO] [Chunk 40/42] Loading events 1,950,000 to 2,000,000...
2025-12-07 03:37:11,298 [INFO] [Chunk 40/42] Processed. Total samples: 2,000,000
2025-12-07 03:37:11,299 [INFO] [Chunk 41/42] Loading events 2,000,000 to 2,050,000...
2025-12-07 03:38:13,751 [INFO] [Chunk 41/42] Processed. Total samples: 2,050,000
2025-12-07 03:38:13,752 [INFO] [Chunk 42/42] Loading events 2,050,000 to 2,100,000...
2025-12-07 03:39:14,766 [INFO] [Chunk 42/42] Processed. Total samples: 2,052,494
2025-12-07 03:39:14,767 [INFO] Converting to numpy arrays...
2025-12-07 03:39:16,535 [INFO] Feature matrix shape: (2052494, 24)
2025-12-07 03:39:16,632 [INFO] Label distribution: 0=748,894, 1=1,303,600
2025-12-07 03:39:16,632 [INFO] Splitting data 80/20...
2025-12-07 03:39:17,968 [INFO] Training samples: 1,641,995
2025-12-07 03:39:17,968 [INFO] Test samples: 410,499
2025-12-07 03:39:17,968 [INFO] Scaling features...
2025-12-07 03:39:18,905 [INFO] Training Random Forest model...
2025-12-07 03:39:18,906 [INFO] Parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_features': 'sqrt', 'class_weight': 'balanced', 'bootstrap': True, 'oob_score': True, 'random_state': 42, 'n_jobs': -1}
2025-12-07 03:43:59,663 [INFO] Training complete!
2025-12-07 03:43:59,664 [INFO] Evaluating model...
2025-12-07 03:44:04,990 [INFO] ==================================================
2025-12-07 03:44:04,991 [INFO] METRICS:
2025-12-07 03:44:04,991 [INFO]   Accuracy:  0.9999
2025-12-07 03:44:04,991 [INFO]   Precision: 1.0000
2025-12-07 03:44:04,991 [INFO]   Recall:    0.9999
2025-12-07 03:44:04,991 [INFO]   F1 Score:  0.9999
2025-12-07 03:44:04,991 [INFO]   ROC AUC:   1.0000
2025-12-07 03:44:04,991 [INFO]   Confusion Matrix:
[[149773      6]
 [    23 260697]]
2025-12-07 03:44:04,992 [INFO] ==================================================
2025-12-07 03:44:06,190 [INFO] Model saved to: /home/rana-workspace/ssh_guardian_v3.0/ml_models/random_forest_20251207_034404.pkl
2025-12-07 03:44:06,219 [INFO] Model random_forest_20251207_034404 saved to database
2025-12-07 03:44:06,241 [INFO] Model random_forest_20251207_034404 promoted to production!
2025-12-07 03:44:06,279 [INFO] ======================================================================
2025-12-07 03:44:06,280 [INFO] TRAINING COMPLETE!
2025-12-07 03:44:06,280 [INFO] ======================================================================
2025-12-07 03:44:06,280 [INFO] Model: random_forest_20251207_034404
2025-12-07 03:44:06,280 [INFO] Samples: 1,641,995
2025-12-07 03:44:06,280 [INFO] Accuracy: 0.9999
2025-12-07 03:44:06,280 [INFO] F1 Score: 0.9999
2025-12-07 03:44:06,280 [INFO] Status: production
2025-12-07 03:44:06,280 [INFO] ======================================================================
2025-12-07 03:57:19,220 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-07 03:57:19.220752
2025-12-07 03:57:20,679 [INFO] ======================================================================
2025-12-07 03:57:20,679 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-07 03:57:20,680 [INFO] ======================================================================
2025-12-07 03:57:24,854 [INFO] Total events in range: 2,052,494
2025-12-07 03:57:24,854 [INFO] Processing 42 chunks of 50,000 events each...
2025-12-07 03:57:24,854 [INFO] Using FeatureExtractor with 42 features
2025-12-07 03:57:24,854 [INFO] [Chunk 1/42] Loading events 0 to 50,000...
2025-12-07 03:57:32,214 [INFO] [Chunk 1/42] Processed. Total samples: 50,000
2025-12-07 03:57:32,215 [INFO] [Chunk 2/42] Loading events 50,000 to 100,000...
2025-12-07 03:57:39,993 [INFO] [Chunk 2/42] Processed. Total samples: 100,000
2025-12-07 03:57:39,994 [INFO] [Chunk 3/42] Loading events 100,000 to 150,000...
2025-12-07 03:57:48,479 [INFO] [Chunk 3/42] Processed. Total samples: 150,000
2025-12-07 03:57:48,479 [INFO] [Chunk 4/42] Loading events 150,000 to 200,000...
2025-12-07 03:57:59,429 [INFO] [Chunk 4/42] Processed. Total samples: 200,000
2025-12-07 03:57:59,430 [INFO] [Chunk 5/42] Loading events 200,000 to 250,000...
2025-12-07 03:58:11,681 [INFO] [Chunk 5/42] Processed. Total samples: 250,000
2025-12-07 03:58:11,681 [INFO] [Chunk 6/42] Loading events 250,000 to 300,000...
2025-12-07 03:58:25,373 [INFO] [Chunk 6/42] Processed. Total samples: 300,000
2025-12-07 03:58:25,374 [INFO] [Chunk 7/42] Loading events 300,000 to 350,000...
2025-12-07 03:58:40,795 [INFO] [Chunk 7/42] Processed. Total samples: 350,000
2025-12-07 03:58:40,795 [INFO] [Chunk 8/42] Loading events 350,000 to 400,000...
2025-12-07 03:58:56,260 [INFO] [Chunk 8/42] Processed. Total samples: 400,000
2025-12-07 03:58:56,260 [INFO] [Chunk 9/42] Loading events 400,000 to 450,000...
2025-12-07 03:59:14,979 [INFO] [Chunk 9/42] Processed. Total samples: 450,000
2025-12-07 03:59:14,979 [INFO] [Chunk 10/42] Loading events 450,000 to 500,000...
2025-12-07 03:59:34,505 [INFO] [Chunk 10/42] Processed. Total samples: 500,000
2025-12-07 03:59:34,505 [INFO] [Chunk 11/42] Loading events 500,000 to 550,000...
2025-12-07 03:59:56,148 [INFO] [Chunk 11/42] Processed. Total samples: 550,000
2025-12-07 03:59:56,148 [INFO] [Chunk 12/42] Loading events 550,000 to 600,000...
2025-12-07 04:00:19,874 [INFO] [Chunk 12/42] Processed. Total samples: 600,000
2025-12-07 04:00:19,874 [INFO] [Chunk 13/42] Loading events 600,000 to 650,000...
2025-12-07 04:00:41,374 [INFO] [Chunk 13/42] Processed. Total samples: 650,000
2025-12-07 04:00:41,375 [INFO] [Chunk 14/42] Loading events 650,000 to 700,000...
2025-12-07 04:01:07,932 [INFO] [Chunk 14/42] Processed. Total samples: 700,000
2025-12-07 04:01:07,932 [INFO] [Chunk 15/42] Loading events 700,000 to 750,000...
2025-12-07 04:01:33,258 [INFO] [Chunk 15/42] Processed. Total samples: 750,000
2025-12-07 04:01:33,258 [INFO] [Chunk 16/42] Loading events 750,000 to 800,000...
2025-12-07 04:01:58,517 [INFO] [Chunk 16/42] Processed. Total samples: 800,000
2025-12-07 04:01:58,518 [INFO] [Chunk 17/42] Loading events 800,000 to 850,000...
2025-12-07 04:02:26,861 [INFO] [Chunk 17/42] Processed. Total samples: 850,000
2025-12-07 04:02:26,862 [INFO] [Chunk 18/42] Loading events 850,000 to 900,000...
2025-12-07 04:02:56,960 [INFO] [Chunk 18/42] Processed. Total samples: 900,000
2025-12-07 04:02:56,960 [INFO] [Chunk 19/42] Loading events 900,000 to 950,000...
2025-12-07 04:03:29,375 [INFO] [Chunk 19/42] Processed. Total samples: 950,000
2025-12-07 04:03:29,376 [INFO] [Chunk 20/42] Loading events 950,000 to 1,000,000...
2025-12-07 04:04:01,167 [INFO] [Chunk 20/42] Processed. Total samples: 1,000,000
2025-12-07 04:04:01,167 [INFO] [Chunk 21/42] Loading events 1,000,000 to 1,050,000...
2025-12-07 04:04:36,663 [INFO] [Chunk 21/42] Processed. Total samples: 1,050,000
2025-12-07 04:04:36,663 [INFO] [Chunk 22/42] Loading events 1,050,000 to 1,100,000...
2025-12-07 04:05:11,966 [INFO] [Chunk 22/42] Processed. Total samples: 1,100,000
2025-12-07 04:05:11,966 [INFO] [Chunk 23/42] Loading events 1,100,000 to 1,150,000...
2025-12-07 04:05:48,029 [INFO] [Chunk 23/42] Processed. Total samples: 1,150,000
2025-12-07 04:05:48,030 [INFO] [Chunk 24/42] Loading events 1,150,000 to 1,200,000...
2025-12-07 04:06:28,243 [INFO] [Chunk 24/42] Processed. Total samples: 1,200,000
2025-12-07 04:06:28,245 [INFO] [Chunk 25/42] Loading events 1,200,000 to 1,250,000...
2025-12-07 04:07:08,003 [INFO] [Chunk 25/42] Processed. Total samples: 1,250,000
2025-12-07 04:07:08,004 [INFO] [Chunk 26/42] Loading events 1,250,000 to 1,300,000...
2025-12-07 04:07:49,126 [INFO] [Chunk 26/42] Processed. Total samples: 1,300,000
2025-12-07 04:07:49,127 [INFO] [Chunk 27/42] Loading events 1,300,000 to 1,350,000...
2025-12-07 04:08:32,438 [INFO] [Chunk 27/42] Processed. Total samples: 1,350,000
2025-12-07 04:08:32,439 [INFO] [Chunk 28/42] Loading events 1,350,000 to 1,400,000...
2025-12-07 04:09:17,705 [INFO] [Chunk 28/42] Processed. Total samples: 1,400,000
2025-12-07 04:09:17,706 [INFO] [Chunk 29/42] Loading events 1,400,000 to 1,450,000...
2025-12-07 04:10:05,105 [INFO] [Chunk 29/42] Processed. Total samples: 1,450,000
2025-12-07 04:10:05,106 [INFO] [Chunk 30/42] Loading events 1,450,000 to 1,500,000...
2025-12-07 04:10:50,884 [INFO] [Chunk 30/42] Processed. Total samples: 1,500,000
2025-12-07 04:10:50,884 [INFO] [Chunk 31/42] Loading events 1,500,000 to 1,550,000...
2025-12-07 04:11:40,014 [INFO] [Chunk 31/42] Processed. Total samples: 1,550,000
2025-12-07 04:11:40,014 [INFO] [Chunk 32/42] Loading events 1,550,000 to 1,600,000...
2025-12-07 04:12:29,068 [INFO] [Chunk 32/42] Processed. Total samples: 1,600,000
2025-12-07 04:12:29,069 [INFO] [Chunk 33/42] Loading events 1,600,000 to 1,650,000...
2025-12-07 04:13:21,027 [INFO] [Chunk 33/42] Processed. Total samples: 1,650,000
2025-12-07 04:13:21,028 [INFO] [Chunk 34/42] Loading events 1,650,000 to 1,700,000...
2025-12-07 04:14:15,223 [INFO] [Chunk 34/42] Processed. Total samples: 1,700,000
2025-12-07 04:14:15,223 [INFO] [Chunk 35/42] Loading events 1,700,000 to 1,750,000...
2025-12-07 04:15:09,378 [INFO] [Chunk 35/42] Processed. Total samples: 1,750,000
2025-12-07 04:15:09,378 [INFO] [Chunk 36/42] Loading events 1,750,000 to 1,800,000...
2025-12-07 04:16:06,973 [INFO] [Chunk 36/42] Processed. Total samples: 1,800,000
2025-12-07 04:16:06,973 [INFO] [Chunk 37/42] Loading events 1,800,000 to 1,850,000...
2025-12-07 04:17:08,142 [INFO] [Chunk 37/42] Processed. Total samples: 1,850,000
2025-12-07 04:17:08,143 [INFO] [Chunk 38/42] Loading events 1,850,000 to 1,900,000...
2025-12-07 04:18:12,062 [INFO] [Chunk 38/42] Processed. Total samples: 1,900,000
2025-12-07 04:18:12,062 [INFO] [Chunk 39/42] Loading events 1,900,000 to 1,950,000...
2025-12-07 04:19:14,425 [INFO] [Chunk 39/42] Processed. Total samples: 1,950,000
2025-12-07 04:19:14,426 [INFO] [Chunk 40/42] Loading events 1,950,000 to 2,000,000...
2025-12-07 04:20:21,117 [INFO] [Chunk 40/42] Processed. Total samples: 2,000,000
2025-12-07 04:20:21,117 [INFO] [Chunk 41/42] Loading events 2,000,000 to 2,050,000...
2025-12-07 04:21:25,651 [INFO] [Chunk 41/42] Processed. Total samples: 2,050,000
2025-12-07 04:21:25,651 [INFO] [Chunk 42/42] Loading events 2,050,000 to 2,100,000...
2025-12-07 04:22:30,177 [INFO] [Chunk 42/42] Processed. Total samples: 2,052,494
2025-12-07 04:22:30,178 [INFO] Converting to numpy arrays...
2025-12-07 04:22:32,820 [INFO] Feature matrix shape: (2052494, 42)
2025-12-07 04:22:32,910 [INFO] Label distribution: 0=748,894, 1=1,303,600
2025-12-07 04:22:32,911 [INFO] Splitting data 80/20...
2025-12-07 04:22:34,718 [INFO] Training samples: 1,641,995
2025-12-07 04:22:34,718 [INFO] Test samples: 410,499
2025-12-07 04:22:34,718 [INFO] Scaling features...
2025-12-07 04:22:36,346 [INFO] Training Random Forest model...
2025-12-07 04:22:36,347 [INFO] Parameters: {'n_estimators': 300, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_features': 'sqrt', 'class_weight': 'balanced', 'bootstrap': True, 'oob_score': True, 'random_state': 42, 'n_jobs': -1}
2025-12-07 04:29:07,649 [INFO] Training complete!
2025-12-07 04:29:07,650 [INFO] Evaluating model...
2025-12-07 04:29:13,133 [INFO] ==================================================
2025-12-07 04:29:13,133 [INFO] METRICS:
2025-12-07 04:29:13,134 [INFO]   Accuracy:  1.0000
2025-12-07 04:29:13,134 [INFO]   Precision: 1.0000
2025-12-07 04:29:13,134 [INFO]   Recall:    1.0000
2025-12-07 04:29:13,134 [INFO]   F1 Score:  1.0000
2025-12-07 04:29:13,134 [INFO]   ROC AUC:   1.0000
2025-12-07 04:29:13,135 [INFO]   Confusion Matrix:
[[149776      3]
 [     0 260720]]
2025-12-07 04:29:13,135 [INFO] ==================================================
2025-12-07 04:29:14,298 [INFO] Model saved to: /home/rana-workspace/ssh_guardian_v3.0/ml_models/random_forest_20251207_042913.pkl
2025-12-07 04:29:14,321 [INFO] Model random_forest_20251207_042913 saved to database
2025-12-07 04:29:14,346 [INFO] Model random_forest_20251207_042913 promoted to production!
2025-12-07 04:29:14,515 [INFO] ======================================================================
2025-12-07 04:29:14,516 [INFO] TRAINING COMPLETE!
2025-12-07 04:29:14,516 [INFO] ======================================================================
2025-12-07 04:29:14,516 [INFO] Model: random_forest_20251207_042913
2025-12-07 04:29:14,516 [INFO] Samples: 1,641,995
2025-12-07 04:29:14,516 [INFO] Accuracy: 1.0000
2025-12-07 04:29:14,516 [INFO] F1 Score: 1.0000
2025-12-07 04:29:14,516 [INFO] Status: production
2025-12-07 04:29:14,516 [INFO] ======================================================================
2025-12-07 04:44:06,261 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-07 04:44:06.261713
2025-12-07 04:44:07,870 [INFO] ======================================================================
2025-12-07 04:44:07,871 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-07 04:44:07,871 [INFO] ======================================================================
2025-12-07 04:44:11,812 [INFO] Total events in range: 2,052,494
2025-12-07 04:44:11,812 [INFO] Processing 69 chunks of 30,000 events each...
2025-12-07 04:44:11,812 [INFO] Using FeatureExtractor with 42 features
2025-12-07 04:44:11,812 [INFO] [Chunk 1/69] Loading events 0 to 30,000...
2025-12-07 04:44:16,779 [INFO] [Chunk 1/69] Processed. Total samples: 30,000
2025-12-07 04:44:16,779 [INFO] [Chunk 2/69] Loading events 30,000 to 60,000...
2025-12-07 04:44:22,050 [INFO] [Chunk 2/69] Processed. Total samples: 60,000
2025-12-07 04:44:22,051 [INFO] [Chunk 3/69] Loading events 60,000 to 90,000...
2025-12-07 04:44:28,258 [INFO] [Chunk 3/69] Processed. Total samples: 90,000
2025-12-07 04:44:28,258 [INFO] [Chunk 4/69] Loading events 90,000 to 120,000...
2025-12-07 04:44:35,174 [INFO] [Chunk 4/69] Processed. Total samples: 120,000
2025-12-07 04:44:35,174 [INFO] [Chunk 5/69] Loading events 120,000 to 150,000...
2025-12-07 04:44:41,253 [INFO] [Chunk 5/69] Processed. Total samples: 150,000
2025-12-07 04:44:41,254 [INFO] [Chunk 6/69] Loading events 150,000 to 180,000...
2025-12-07 04:44:48,045 [INFO] [Chunk 6/69] Processed. Total samples: 180,000
2025-12-07 04:44:48,045 [INFO] [Chunk 7/69] Loading events 180,000 to 210,000...
2025-12-07 04:44:56,706 [INFO] [Chunk 7/69] Processed. Total samples: 210,000
2025-12-07 04:44:56,707 [INFO] [Chunk 8/69] Loading events 210,000 to 240,000...
2025-12-07 04:45:06,107 [INFO] [Chunk 8/69] Processed. Total samples: 240,000
2025-12-07 04:45:06,108 [INFO] [Chunk 9/69] Loading events 240,000 to 270,000...
2025-12-07 04:45:15,671 [INFO] [Chunk 9/69] Processed. Total samples: 270,000
2025-12-07 04:45:15,672 [INFO] [Chunk 10/69] Loading events 270,000 to 300,000...
2025-12-07 04:45:26,668 [INFO] [Chunk 10/69] Processed. Total samples: 300,000
2025-12-07 04:45:26,669 [INFO] [Chunk 11/69] Loading events 300,000 to 330,000...
2025-12-07 04:45:38,275 [INFO] [Chunk 11/69] Processed. Total samples: 330,000
2025-12-07 04:45:38,276 [INFO] [Chunk 12/69] Loading events 330,000 to 360,000...
2025-12-07 04:45:51,580 [INFO] [Chunk 12/69] Processed. Total samples: 360,000
2025-12-07 04:45:51,580 [INFO] [Chunk 13/69] Loading events 360,000 to 390,000...
2025-12-07 04:46:04,293 [INFO] [Chunk 13/69] Processed. Total samples: 390,000
2025-12-07 04:46:04,293 [INFO] [Chunk 14/69] Loading events 390,000 to 420,000...
2025-12-07 04:46:17,678 [INFO] [Chunk 14/69] Processed. Total samples: 420,000
2025-12-07 04:46:17,679 [INFO] [Chunk 15/69] Loading events 420,000 to 450,000...
2025-12-07 04:46:33,033 [INFO] [Chunk 15/69] Processed. Total samples: 450,000
2025-12-07 04:46:33,034 [INFO] [Chunk 16/69] Loading events 450,000 to 480,000...
2025-12-07 04:46:48,671 [INFO] [Chunk 16/69] Processed. Total samples: 480,000
2025-12-07 04:46:48,671 [INFO] [Chunk 17/69] Loading events 480,000 to 510,000...
2025-12-07 04:47:06,456 [INFO] [Chunk 17/69] Processed. Total samples: 510,000
2025-12-07 04:47:06,456 [INFO] [Chunk 18/69] Loading events 510,000 to 540,000...
2025-12-07 04:47:23,809 [INFO] [Chunk 18/69] Processed. Total samples: 540,000
2025-12-07 04:47:23,809 [INFO] [Chunk 19/69] Loading events 540,000 to 570,000...
2025-12-07 04:47:42,530 [INFO] [Chunk 19/69] Processed. Total samples: 570,000
2025-12-07 04:47:42,531 [INFO] [Chunk 20/69] Loading events 570,000 to 600,000...
2025-12-07 04:48:02,432 [INFO] [Chunk 20/69] Processed. Total samples: 600,000
2025-12-07 04:48:02,433 [INFO] [Chunk 21/69] Loading events 600,000 to 630,000...
2025-12-07 04:48:21,777 [INFO] [Chunk 21/69] Processed. Total samples: 630,000
2025-12-07 04:48:21,778 [INFO] [Chunk 22/69] Loading events 630,000 to 660,000...
2025-12-07 04:48:41,115 [INFO] [Chunk 22/69] Processed. Total samples: 660,000
2025-12-07 04:48:41,115 [INFO] [Chunk 23/69] Loading events 660,000 to 690,000...
2025-12-07 04:49:01,885 [INFO] [Chunk 23/69] Processed. Total samples: 690,000
2025-12-07 04:49:01,885 [INFO] [Chunk 24/69] Loading events 690,000 to 720,000...
2025-12-07 04:49:24,874 [INFO] [Chunk 24/69] Processed. Total samples: 720,000
2025-12-07 04:49:24,874 [INFO] [Chunk 25/69] Loading events 720,000 to 750,000...
2025-12-07 04:49:45,607 [INFO] [Chunk 25/69] Processed. Total samples: 750,000
2025-12-07 04:49:45,608 [INFO] [Chunk 26/69] Loading events 750,000 to 780,000...
2025-12-07 04:50:09,308 [INFO] [Chunk 26/69] Processed. Total samples: 780,000
2025-12-07 04:50:09,309 [INFO] [Chunk 27/69] Loading events 780,000 to 810,000...
2025-12-07 04:50:32,718 [INFO] [Chunk 27/69] Processed. Total samples: 810,000
2025-12-07 04:50:32,719 [INFO] [Chunk 28/69] Loading events 810,000 to 840,000...
2025-12-07 04:50:56,960 [INFO] [Chunk 28/69] Processed. Total samples: 840,000
2025-12-07 04:50:56,961 [INFO] [Chunk 29/69] Loading events 840,000 to 870,000...
2025-12-07 04:51:22,007 [INFO] [Chunk 29/69] Processed. Total samples: 870,000
2025-12-07 04:51:22,008 [INFO] [Chunk 30/69] Loading events 870,000 to 900,000...
2025-12-07 04:51:49,555 [INFO] [Chunk 30/69] Processed. Total samples: 900,000
2025-12-07 04:51:49,556 [INFO] [Chunk 31/69] Loading events 900,000 to 930,000...
2025-12-07 04:52:15,913 [INFO] [Chunk 31/69] Processed. Total samples: 930,000
2025-12-07 04:52:15,914 [INFO] [Chunk 32/69] Loading events 930,000 to 960,000...
2025-12-07 04:52:44,160 [INFO] [Chunk 32/69] Processed. Total samples: 960,000
2025-12-07 04:52:44,161 [INFO] [Chunk 33/69] Loading events 960,000 to 990,000...
2025-12-07 04:53:14,492 [INFO] [Chunk 33/69] Processed. Total samples: 990,000
2025-12-07 04:53:14,492 [INFO] [Chunk 34/69] Loading events 990,000 to 1,020,000...
2025-12-07 04:53:46,016 [INFO] [Chunk 34/69] Processed. Total samples: 1,020,000
2025-12-07 04:53:46,017 [INFO] [Chunk 35/69] Loading events 1,020,000 to 1,050,000...
2025-12-07 04:54:15,949 [INFO] [Chunk 35/69] Processed. Total samples: 1,050,000
2025-12-07 04:54:15,950 [INFO] [Chunk 36/69] Loading events 1,050,000 to 1,080,000...
2025-12-07 04:54:46,442 [INFO] [Chunk 36/69] Processed. Total samples: 1,080,000
2025-12-07 04:54:46,442 [INFO] [Chunk 37/69] Loading events 1,080,000 to 1,110,000...
2025-12-07 04:55:20,026 [INFO] [Chunk 37/69] Processed. Total samples: 1,110,000
2025-12-07 04:55:20,027 [INFO] [Chunk 38/69] Loading events 1,110,000 to 1,140,000...
2025-12-07 04:55:53,838 [INFO] [Chunk 38/69] Processed. Total samples: 1,140,000
2025-12-07 04:55:53,839 [INFO] [Chunk 39/69] Loading events 1,140,000 to 1,170,000...
2025-12-07 04:56:29,143 [INFO] [Chunk 39/69] Processed. Total samples: 1,170,000
2025-12-07 04:56:29,143 [INFO] [Chunk 40/69] Loading events 1,170,000 to 1,200,000...
2025-12-07 04:57:03,554 [INFO] [Chunk 40/69] Processed. Total samples: 1,200,000
2025-12-07 04:57:03,555 [INFO] [Chunk 41/69] Loading events 1,200,000 to 1,230,000...
2025-12-07 04:57:38,467 [INFO] [Chunk 41/69] Processed. Total samples: 1,230,000
2025-12-07 04:57:38,468 [INFO] [Chunk 42/69] Loading events 1,230,000 to 1,260,000...
2025-12-07 04:58:16,607 [INFO] [Chunk 42/69] Processed. Total samples: 1,260,000
2025-12-07 04:58:16,607 [INFO] [Chunk 43/69] Loading events 1,260,000 to 1,290,000...
2025-12-07 04:58:51,947 [INFO] [Chunk 43/69] Processed. Total samples: 1,290,000
2025-12-07 04:58:51,947 [INFO] [Chunk 44/69] Loading events 1,290,000 to 1,320,000...
2025-12-07 04:59:30,680 [INFO] [Chunk 44/69] Processed. Total samples: 1,320,000
2025-12-07 04:59:30,681 [INFO] [Chunk 45/69] Loading events 1,320,000 to 1,350,000...
2025-12-07 05:00:12,503 [INFO] [Chunk 45/69] Processed. Total samples: 1,350,000
2025-12-07 05:00:12,504 [INFO] [Chunk 46/69] Loading events 1,350,000 to 1,380,000...
2025-12-07 05:00:56,277 [INFO] [Chunk 46/69] Processed. Total samples: 1,380,000
2025-12-07 05:00:56,278 [INFO] [Chunk 47/69] Loading events 1,380,000 to 1,410,000...
2025-12-07 05:01:38,659 [INFO] [Chunk 47/69] Processed. Total samples: 1,410,000
2025-12-07 05:01:38,659 [INFO] [Chunk 48/69] Loading events 1,410,000 to 1,440,000...
2025-12-07 05:02:21,900 [INFO] [Chunk 48/69] Processed. Total samples: 1,440,000
2025-12-07 05:02:21,901 [INFO] [Chunk 49/69] Loading events 1,440,000 to 1,470,000...
2025-12-07 05:03:08,520 [INFO] [Chunk 49/69] Processed. Total samples: 1,470,000
2025-12-07 05:03:08,520 [INFO] [Chunk 50/69] Loading events 1,470,000 to 1,500,000...
2025-12-07 05:03:53,978 [INFO] [Chunk 50/69] Processed. Total samples: 1,500,000
2025-12-07 05:03:53,979 [INFO] [Chunk 51/69] Loading events 1,500,000 to 1,530,000...
2025-12-07 05:04:40,149 [INFO] [Chunk 51/69] Processed. Total samples: 1,530,000
2025-12-07 05:04:40,150 [INFO] [Chunk 52/69] Loading events 1,530,000 to 1,560,000...
2025-12-07 05:05:28,915 [INFO] [Chunk 52/69] Processed. Total samples: 1,560,000
2025-12-07 05:05:28,915 [INFO] [Chunk 53/69] Loading events 1,560,000 to 1,590,000...
2025-12-07 05:06:18,179 [INFO] [Chunk 53/69] Processed. Total samples: 1,590,000
2025-12-07 05:06:18,180 [INFO] [Chunk 54/69] Loading events 1,590,000 to 1,620,000...
2025-12-07 05:07:06,592 [INFO] [Chunk 54/69] Processed. Total samples: 1,620,000
2025-12-07 05:07:06,592 [INFO] [Chunk 55/69] Loading events 1,620,000 to 1,650,000...
2025-12-07 05:07:54,298 [INFO] [Chunk 55/69] Processed. Total samples: 1,650,000
2025-12-07 05:07:54,299 [INFO] [Chunk 56/69] Loading events 1,650,000 to 1,680,000...
2025-12-07 05:08:45,450 [INFO] [Chunk 56/69] Processed. Total samples: 1,680,000
2025-12-07 05:08:45,450 [INFO] [Chunk 57/69] Loading events 1,680,000 to 1,710,000...
2025-12-07 05:09:36,140 [INFO] [Chunk 57/69] Processed. Total samples: 1,710,000
2025-12-07 05:09:36,140 [INFO] [Chunk 58/69] Loading events 1,710,000 to 1,740,000...
2025-12-07 05:10:29,541 [INFO] [Chunk 58/69] Processed. Total samples: 1,740,000
2025-12-07 05:10:29,542 [INFO] [Chunk 59/69] Loading events 1,740,000 to 1,770,000...
2025-12-07 05:11:23,109 [INFO] [Chunk 59/69] Processed. Total samples: 1,770,000
2025-12-07 05:11:23,109 [INFO] [Chunk 60/69] Loading events 1,770,000 to 1,800,000...
2025-12-07 05:12:13,055 [INFO] [Chunk 60/69] Processed. Total samples: 1,800,000
2025-12-07 05:12:13,055 [INFO] [Chunk 61/69] Loading events 1,800,000 to 1,830,000...
2025-12-07 05:13:06,837 [INFO] [Chunk 61/69] Processed. Total samples: 1,830,000
2025-12-07 05:13:06,838 [INFO] [Chunk 62/69] Loading events 1,830,000 to 1,860,000...
2025-12-07 05:14:00,296 [INFO] [Chunk 62/69] Processed. Total samples: 1,860,000
2025-12-07 05:14:00,297 [INFO] [Chunk 63/69] Loading events 1,860,000 to 1,890,000...
2025-12-07 05:14:55,438 [INFO] [Chunk 63/69] Processed. Total samples: 1,890,000
2025-12-07 05:14:55,439 [INFO] [Chunk 64/69] Loading events 1,890,000 to 1,920,000...
2025-12-07 05:15:53,504 [INFO] [Chunk 64/69] Processed. Total samples: 1,920,000
2025-12-07 05:15:53,504 [INFO] [Chunk 65/69] Loading events 1,920,000 to 1,950,000...
2025-12-07 05:16:51,687 [INFO] [Chunk 65/69] Processed. Total samples: 1,950,000
2025-12-07 05:16:51,687 [INFO] [Chunk 66/69] Loading events 1,950,000 to 1,980,000...
2025-12-07 05:17:51,936 [INFO] [Chunk 66/69] Processed. Total samples: 1,980,000
2025-12-07 05:17:51,937 [INFO] [Chunk 67/69] Loading events 1,980,000 to 2,010,000...
2025-12-07 05:18:50,263 [INFO] [Chunk 67/69] Processed. Total samples: 2,010,000
2025-12-07 05:18:50,264 [INFO] [Chunk 68/69] Loading events 2,010,000 to 2,040,000...
2025-12-07 05:19:51,853 [INFO] [Chunk 68/69] Processed. Total samples: 2,040,000
2025-12-07 05:19:51,854 [INFO] [Chunk 69/69] Loading events 2,040,000 to 2,070,000...
2025-12-07 05:20:55,746 [INFO] [Chunk 69/69] Processed. Total samples: 2,052,494
2025-12-07 05:20:55,747 [INFO] Converting to numpy arrays...
2025-12-07 05:20:59,093 [INFO] Feature matrix shape: (2052494, 42)
2025-12-07 05:20:59,103 [INFO] Label distribution (before noise): 0=867,512, 1=1,184,982
2025-12-07 05:20:59,287 [INFO] Injected 5.0% label noise (102,624 labels flipped)
2025-12-07 05:20:59,291 [INFO] Label distribution (after noise): 0=883,172, 1=1,169,322
2025-12-07 05:20:59,291 [INFO] Splitting data 80/20...
2025-12-07 05:21:01,119 [INFO] Training samples: 1,641,995
2025-12-07 05:21:01,120 [INFO] Test samples: 410,499
2025-12-07 05:21:01,120 [INFO] Scaling features...
2025-12-07 05:21:03,129 [INFO] Training Random Forest model...
2025-12-07 05:21:03,130 [INFO] Parameters: {'n_estimators': 150, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 5, 'max_features': 'sqrt', 'class_weight': 'balanced', 'bootstrap': True, 'oob_score': True, 'random_state': 42, 'n_jobs': 3}
2025-12-07 05:27:29,220 [INFO] Training complete!
2025-12-07 05:27:29,222 [INFO] Evaluating model...
2025-12-07 05:27:38,494 [INFO] ==================================================
2025-12-07 05:27:38,495 [INFO] METRICS:
2025-12-07 05:27:38,495 [INFO]   Accuracy:  0.9050
2025-12-07 05:27:38,495 [INFO]   Precision: 0.8960
2025-12-07 05:27:38,495 [INFO]   Recall:    0.9426
2025-12-07 05:27:38,495 [INFO]   F1 Score:  0.9187
2025-12-07 05:27:38,495 [INFO]   ROC AUC:   0.9397
2025-12-07 05:27:38,496 [INFO]   Confusion Matrix:
[[151052  25582]
 [ 13422 220443]]
2025-12-07 05:27:38,496 [INFO] ==================================================
2025-12-07 05:27:41,145 [INFO] Model saved to: /home/rana-workspace/ssh_guardian_v3.0/ml_models/random_forest_20251207_052738.pkl
2025-12-07 05:27:41,185 [INFO] Model random_forest_20251207_052738 saved to database
2025-12-07 05:27:41,203 [INFO] Model random_forest_20251207_052738 promoted to production!
2025-12-07 05:27:41,511 [INFO] ======================================================================
2025-12-07 05:27:41,511 [INFO] TRAINING COMPLETE!
2025-12-07 05:27:41,511 [INFO] ======================================================================
2025-12-07 05:27:41,512 [INFO] Model: random_forest_20251207_052738
2025-12-07 05:27:41,512 [INFO] Samples: 1,641,995
2025-12-07 05:27:41,512 [INFO] Accuracy: 0.9050
2025-12-07 05:27:41,512 [INFO] F1 Score: 0.9187
2025-12-07 05:27:41,512 [INFO] Status: production
2025-12-07 05:27:41,512 [INFO] ======================================================================
2025-12-21 06:29:27,641 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-21 06:29:27.641742
2025-12-21 06:29:29,310 [INFO] ======================================================================
2025-12-21 06:29:29,311 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-21 06:29:29,311 [INFO] ======================================================================
2025-12-21 06:29:31,245 [INFO] Total events in range: 749
2025-12-21 06:29:31,245 [INFO] Processing 1 chunks of 30,000 events each...
2025-12-21 06:29:31,245 [INFO] Using FeatureExtractor with 50 features
2025-12-21 06:29:31,245 [INFO] [Chunk 1/1] Loading events 0 to 30,000...
2025-12-21 06:29:31,593 [INFO] [Chunk 1/1] Processed. Total samples: 749
2025-12-21 06:29:31,594 [INFO] Converting to numpy arrays...
2025-12-21 06:29:31,681 [INFO] Feature matrix shape: (749, 50)
2025-12-21 06:29:31,685 [INFO] Label distribution (before noise): 0=333, 1=416
2025-12-21 06:29:31,686 [INFO] Injected 5.0% label noise (37 labels flipped)
2025-12-21 06:29:31,686 [INFO] Label distribution (after noise): 0=330, 1=419
2025-12-21 06:29:31,686 [INFO] Splitting data 80/20...
2025-12-21 06:29:31,699 [INFO] Training samples: 599
2025-12-21 06:29:31,700 [INFO] Test samples: 150
2025-12-21 06:29:31,700 [INFO] Scaling features...
2025-12-21 06:29:31,703 [INFO] Training Random Forest model...
2025-12-21 06:29:31,703 [INFO] Parameters: {'n_estimators': 150, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 5, 'max_features': 'sqrt', 'class_weight': 'balanced', 'bootstrap': True, 'oob_score': True, 'random_state': 42, 'n_jobs': 3}
2025-12-21 06:29:32,279 [INFO] Training complete!
2025-12-21 06:29:32,280 [INFO] Evaluating model...
2025-12-21 06:29:32,420 [INFO] ==================================================
2025-12-21 06:29:32,420 [INFO] METRICS:
2025-12-21 06:29:32,420 [INFO]   Accuracy:  0.9333
2025-12-21 06:29:32,421 [INFO]   Precision: 0.9405
2025-12-21 06:29:32,421 [INFO]   Recall:    0.9405
2025-12-21 06:29:32,421 [INFO]   F1 Score:  0.9405
2025-12-21 06:29:32,421 [INFO]   ROC AUC:   0.9379
2025-12-21 06:29:32,421 [INFO]   Confusion Matrix:
[[61  5]
 [ 5 79]]
2025-12-21 06:29:32,421 [INFO] ==================================================
2025-12-21 06:29:32,432 [INFO] Model saved to: /home/rana-workspace/ssh_guardian_v3.0/ml_models/random_forest_20251221_062932.pkl
2025-12-21 06:29:32,435 [ERROR] Failed to save model to database: 1054 (42S22): Unknown column 'feature_names' in 'field list'
2025-12-21 06:29:32,441 [ERROR] Failed to promote model: 1054 (42S22): Unknown column 'promoted_to_production_at' in 'field list'
2025-12-21 06:29:32,448 [INFO] ======================================================================
2025-12-21 06:29:32,449 [INFO] TRAINING COMPLETE!
2025-12-21 06:29:32,449 [INFO] ======================================================================
2025-12-21 06:29:32,449 [INFO] Model: random_forest_20251221_062932
2025-12-21 06:29:32,449 [INFO] Samples: 599
2025-12-21 06:29:32,449 [INFO] Accuracy: 0.9333
2025-12-21 06:29:32,449 [INFO] F1 Score: 0.9405
2025-12-21 06:29:32,449 [INFO] Status: production
2025-12-21 06:29:32,449 [INFO] ======================================================================
2025-12-21 06:29:45,482 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-21 06:29:45.482643
2025-12-21 06:29:47,117 [INFO] ======================================================================
2025-12-21 06:29:47,117 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-21 06:29:47,117 [INFO] ======================================================================
2025-12-21 06:29:49,122 [INFO] Total events in range: 749
2025-12-21 06:29:49,122 [INFO] Processing 1 chunks of 30,000 events each...
2025-12-21 06:29:49,122 [INFO] Using FeatureExtractor with 50 features
2025-12-21 06:29:49,122 [INFO] [Chunk 1/1] Loading events 0 to 30,000...
2025-12-21 06:29:49,504 [INFO] [Chunk 1/1] Processed. Total samples: 749
2025-12-21 06:29:49,504 [INFO] Converting to numpy arrays...
2025-12-21 06:29:49,607 [INFO] Feature matrix shape: (749, 50)
2025-12-21 06:29:49,608 [INFO] Label distribution (before noise): 0=333, 1=416
2025-12-21 06:29:49,609 [INFO] Injected 5.0% label noise (37 labels flipped)
2025-12-21 06:29:49,609 [INFO] Label distribution (after noise): 0=338, 1=411
2025-12-21 06:29:49,609 [INFO] Splitting data 80/20...
2025-12-21 06:29:49,612 [INFO] Training samples: 599
2025-12-21 06:29:49,612 [INFO] Test samples: 150
2025-12-21 06:29:49,612 [INFO] Scaling features...
2025-12-21 06:29:49,615 [INFO] Training Random Forest model...
2025-12-21 06:29:49,615 [INFO] Parameters: {'n_estimators': 150, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 5, 'max_features': 'sqrt', 'class_weight': 'balanced', 'bootstrap': True, 'oob_score': True, 'random_state': 42, 'n_jobs': 3}
2025-12-21 06:29:50,232 [INFO] Training complete!
2025-12-21 06:29:50,233 [INFO] Evaluating model...
2025-12-21 06:29:50,350 [INFO] ==================================================
2025-12-21 06:29:50,351 [INFO] METRICS:
2025-12-21 06:29:50,351 [INFO]   Accuracy:  0.9533
2025-12-21 06:29:50,351 [INFO]   Precision: 0.9630
2025-12-21 06:29:50,351 [INFO]   Recall:    0.9512
2025-12-21 06:29:50,351 [INFO]   F1 Score:  0.9571
2025-12-21 06:29:50,351 [INFO]   ROC AUC:   0.9353
2025-12-21 06:29:50,351 [INFO]   Confusion Matrix:
[[65  3]
 [ 4 78]]
2025-12-21 06:29:50,351 [INFO] ==================================================
2025-12-21 06:29:50,362 [INFO] Model saved to: /home/rana-workspace/ssh_guardian_v3.0/ml_models/random_forest_20251221_062950.pkl
2025-12-21 06:29:50,365 [ERROR] Failed to save model to database: 1054 (42S22): Unknown column 'feature_names' in 'field list'
2025-12-21 06:29:50,370 [ERROR] Failed to promote model: 1054 (42S22): Unknown column 'promoted_to_production_at' in 'field list'
2025-12-21 06:29:50,376 [INFO] ======================================================================
2025-12-21 06:29:50,376 [INFO] TRAINING COMPLETE!
2025-12-21 06:29:50,376 [INFO] ======================================================================
2025-12-21 06:29:50,376 [INFO] Model: random_forest_20251221_062950
2025-12-21 06:29:50,376 [INFO] Samples: 599
2025-12-21 06:29:50,376 [INFO] Accuracy: 0.9533
2025-12-21 06:29:50,376 [INFO] F1 Score: 0.9571
2025-12-21 06:29:50,376 [INFO] Status: production
2025-12-21 06:29:50,377 [INFO] ======================================================================
2025-12-21 06:29:58,265 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-21 06:29:58.265547
2025-12-21 06:29:59,864 [INFO] ======================================================================
2025-12-21 06:29:59,864 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-21 06:29:59,865 [INFO] ======================================================================
2025-12-21 06:30:02,267 [INFO] Total events in range: 749
2025-12-21 06:30:02,268 [INFO] Processing 1 chunks of 30,000 events each...
2025-12-21 06:30:02,268 [INFO] Using FeatureExtractor with 50 features
2025-12-21 06:30:02,268 [INFO] [Chunk 1/1] Loading events 0 to 30,000...
2025-12-21 06:30:02,772 [INFO] [Chunk 1/1] Processed. Total samples: 749
2025-12-21 06:30:02,772 [INFO] Converting to numpy arrays...
2025-12-21 06:30:02,864 [INFO] Feature matrix shape: (749, 50)
2025-12-21 06:30:02,864 [INFO] Label distribution (before noise): 0=333, 1=416
2025-12-21 06:30:02,865 [INFO] Injected 5.0% label noise (37 labels flipped)
2025-12-21 06:30:02,865 [INFO] Label distribution (after noise): 0=338, 1=411
2025-12-21 06:30:02,865 [INFO] Splitting data 80/20...
2025-12-21 06:30:02,868 [INFO] Training samples: 599
2025-12-21 06:30:02,868 [INFO] Test samples: 150
2025-12-21 06:30:02,868 [INFO] Scaling features...
2025-12-21 06:30:02,870 [INFO] Training Random Forest model...
2025-12-21 06:30:02,870 [INFO] Parameters: {'n_estimators': 150, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 5, 'max_features': 'sqrt', 'class_weight': 'balanced', 'bootstrap': True, 'oob_score': True, 'random_state': 42, 'n_jobs': 3}
2025-12-21 06:30:03,630 [INFO] Training complete!
2025-12-21 06:30:03,630 [INFO] Evaluating model...
2025-12-21 06:30:03,770 [INFO] ==================================================
2025-12-21 06:30:03,772 [INFO] METRICS:
2025-12-21 06:30:03,772 [INFO]   Accuracy:  0.9067
2025-12-21 06:30:03,772 [INFO]   Precision: 0.9048
2025-12-21 06:30:03,772 [INFO]   Recall:    0.9268
2025-12-21 06:30:03,772 [INFO]   F1 Score:  0.9157
2025-12-21 06:30:03,773 [INFO]   ROC AUC:   0.9275
2025-12-21 06:30:03,773 [INFO]   Confusion Matrix:
[[60  8]
 [ 6 76]]
2025-12-21 06:30:03,773 [INFO] ==================================================
2025-12-21 06:30:03,789 [INFO] Model saved to: /home/rana-workspace/ssh_guardian_v3.0/ml_models/random_forest_20251221_063003.pkl
2025-12-21 06:30:03,793 [ERROR] Failed to save model to database: 1054 (42S22): Unknown column 'feature_names' in 'field list'
2025-12-21 06:30:03,803 [ERROR] Failed to promote model: 1054 (42S22): Unknown column 'promoted_to_production_at' in 'field list'
2025-12-21 06:30:03,818 [INFO] ======================================================================
2025-12-21 06:30:03,819 [INFO] TRAINING COMPLETE!
2025-12-21 06:30:03,819 [INFO] ======================================================================
2025-12-21 06:30:03,819 [INFO] Model: random_forest_20251221_063003
2025-12-21 06:30:03,819 [INFO] Samples: 599
2025-12-21 06:30:03,819 [INFO] Accuracy: 0.9067
2025-12-21 06:30:03,819 [INFO] F1 Score: 0.9157
2025-12-21 06:30:03,819 [INFO] Status: production
2025-12-21 06:30:03,819 [INFO] ======================================================================
2025-12-21 06:30:16,512 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-21 06:30:16.512109
2025-12-21 06:30:18,458 [INFO] ======================================================================
2025-12-21 06:30:18,458 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-21 06:30:18,458 [INFO] ======================================================================
2025-12-21 06:30:20,452 [INFO] Total events in range: 749
2025-12-21 06:30:20,470 [INFO] Processing 1 chunks of 30,000 events each...
2025-12-21 06:30:20,470 [INFO] Using FeatureExtractor with 50 features
2025-12-21 06:30:20,470 [INFO] [Chunk 1/1] Loading events 0 to 30,000...
2025-12-21 06:30:20,917 [INFO] [Chunk 1/1] Processed. Total samples: 749
2025-12-21 06:30:20,917 [INFO] Converting to numpy arrays...
2025-12-21 06:30:21,001 [INFO] Feature matrix shape: (749, 50)
2025-12-21 06:30:21,002 [INFO] Label distribution (before noise): 0=333, 1=416
2025-12-21 06:30:21,002 [INFO] Injected 5.0% label noise (37 labels flipped)
2025-12-21 06:30:21,002 [INFO] Label distribution (after noise): 0=332, 1=417
2025-12-21 06:30:21,002 [INFO] Splitting data 80/20...
2025-12-21 06:30:21,006 [INFO] Training samples: 599
2025-12-21 06:30:21,006 [INFO] Test samples: 150
2025-12-21 06:30:21,006 [INFO] Scaling features...
2025-12-21 06:30:21,008 [INFO] Training Random Forest model...
2025-12-21 06:30:21,009 [INFO] Parameters: {'n_estimators': 150, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 5, 'max_features': 'sqrt', 'class_weight': 'balanced', 'bootstrap': True, 'oob_score': True, 'random_state': 42, 'n_jobs': 3}
2025-12-21 06:30:21,750 [INFO] Training complete!
2025-12-21 06:30:21,750 [INFO] Evaluating model...
2025-12-21 06:30:21,848 [INFO] ==================================================
2025-12-21 06:30:21,848 [INFO] METRICS:
2025-12-21 06:30:21,848 [INFO]   Accuracy:  0.9533
2025-12-21 06:30:21,848 [INFO]   Precision: 0.9753
2025-12-21 06:30:21,848 [INFO]   Recall:    0.9405
2025-12-21 06:30:21,848 [INFO]   F1 Score:  0.9576
2025-12-21 06:30:21,849 [INFO]   ROC AUC:   0.9642
2025-12-21 06:30:21,849 [INFO]   Confusion Matrix:
[[64  2]
 [ 5 79]]
2025-12-21 06:30:21,849 [INFO] ==================================================
2025-12-21 06:30:21,860 [INFO] Model saved to: /home/rana-workspace/ssh_guardian_v3.0/ml_models/random_forest_20251221_063021.pkl
2025-12-21 06:30:21,866 [ERROR] Failed to save model to database: 1054 (42S22): Unknown column 'feature_names' in 'field list'
2025-12-21 06:30:21,873 [ERROR] Failed to promote model: 1054 (42S22): Unknown column 'promoted_to_production_at' in 'field list'
2025-12-21 06:30:21,880 [INFO] ======================================================================
2025-12-21 06:30:21,880 [INFO] TRAINING COMPLETE!
2025-12-21 06:30:21,880 [INFO] ======================================================================
2025-12-21 06:30:21,880 [INFO] Model: random_forest_20251221_063021
2025-12-21 06:30:21,880 [INFO] Samples: 599
2025-12-21 06:30:21,880 [INFO] Accuracy: 0.9533
2025-12-21 06:30:21,880 [INFO] F1 Score: 0.9576
2025-12-21 06:30:21,880 [INFO] Status: production
2025-12-21 06:30:21,881 [INFO] ======================================================================
2025-12-21 06:30:34,275 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-21 06:30:34.275840
2025-12-21 06:30:36,071 [INFO] ======================================================================
2025-12-21 06:30:36,071 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-21 06:30:36,071 [INFO] ======================================================================
2025-12-21 06:30:38,076 [INFO] Total events in range: 749
2025-12-21 06:30:38,076 [INFO] Processing 1 chunks of 30,000 events each...
2025-12-21 06:30:38,076 [INFO] Using FeatureExtractor with 50 features
2025-12-21 06:30:38,076 [INFO] [Chunk 1/1] Loading events 0 to 30,000...
2025-12-21 06:30:38,436 [INFO] [Chunk 1/1] Processed. Total samples: 749
2025-12-21 06:30:38,436 [INFO] Converting to numpy arrays...
2025-12-21 06:30:38,511 [INFO] Feature matrix shape: (749, 50)
2025-12-21 06:30:38,512 [INFO] Label distribution (before noise): 0=333, 1=416
2025-12-21 06:30:38,512 [INFO] Injected 5.0% label noise (37 labels flipped)
2025-12-21 06:30:38,512 [INFO] Label distribution (after noise): 0=334, 1=415
2025-12-21 06:30:38,512 [INFO] Splitting data 80/20...
2025-12-21 06:30:38,516 [INFO] Training samples: 599
2025-12-21 06:30:38,516 [INFO] Test samples: 150
2025-12-21 06:30:38,516 [INFO] Scaling features...
2025-12-21 06:30:38,519 [INFO] Training Random Forest model...
2025-12-21 06:30:38,519 [INFO] Parameters: {'n_estimators': 150, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 5, 'max_features': 'sqrt', 'class_weight': 'balanced', 'bootstrap': True, 'oob_score': True, 'random_state': 42, 'n_jobs': 3}
2025-12-21 06:30:39,170 [INFO] Training complete!
2025-12-21 06:30:39,171 [INFO] Evaluating model...
2025-12-21 06:30:39,305 [INFO] ==================================================
2025-12-21 06:30:39,305 [INFO] METRICS:
2025-12-21 06:30:39,305 [INFO]   Accuracy:  0.9400
2025-12-21 06:30:39,305 [INFO]   Precision: 0.9405
2025-12-21 06:30:39,306 [INFO]   Recall:    0.9518
2025-12-21 06:30:39,306 [INFO]   F1 Score:  0.9461
2025-12-21 06:30:39,306 [INFO]   ROC AUC:   0.9369
2025-12-21 06:30:39,306 [INFO]   Confusion Matrix:
[[62  5]
 [ 4 79]]
2025-12-21 06:30:39,306 [INFO] ==================================================
2025-12-21 06:30:39,319 [INFO] Model saved to: /home/rana-workspace/ssh_guardian_v3.0/ml_models/random_forest_20251221_063039.pkl
2025-12-21 06:30:39,322 [ERROR] Failed to save model to database: 1054 (42S22): Unknown column 'feature_names' in 'field list'
2025-12-21 06:30:39,329 [ERROR] Failed to promote model: 1054 (42S22): Unknown column 'promoted_to_production_at' in 'field list'
2025-12-21 06:30:39,339 [INFO] ======================================================================
2025-12-21 06:30:39,340 [INFO] TRAINING COMPLETE!
2025-12-21 06:30:39,340 [INFO] ======================================================================
2025-12-21 06:30:39,340 [INFO] Model: random_forest_20251221_063039
2025-12-21 06:30:39,340 [INFO] Samples: 599
2025-12-21 06:30:39,340 [INFO] Accuracy: 0.9400
2025-12-21 06:30:39,340 [INFO] F1 Score: 0.9461
2025-12-21 06:30:39,340 [INFO] Status: production
2025-12-21 06:30:39,340 [INFO] ======================================================================
2025-12-21 06:31:02,810 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-21 06:31:02.810751
2025-12-21 06:31:04,544 [INFO] ======================================================================
2025-12-21 06:31:04,544 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-21 06:31:04,544 [INFO] ======================================================================
2025-12-21 06:31:06,610 [INFO] Total events in range: 749
2025-12-21 06:31:06,610 [INFO] Processing 1 chunks of 30,000 events each...
2025-12-21 06:31:06,610 [INFO] Using FeatureExtractor with 50 features
2025-12-21 06:31:06,610 [INFO] [Chunk 1/1] Loading events 0 to 30,000...
2025-12-21 06:31:07,028 [INFO] [Chunk 1/1] Processed. Total samples: 749
2025-12-21 06:31:07,029 [INFO] Converting to numpy arrays...
2025-12-21 06:31:07,123 [INFO] Feature matrix shape: (749, 50)
2025-12-21 06:31:07,124 [INFO] Label distribution (before noise): 0=333, 1=416
2025-12-21 06:31:07,124 [INFO] Injected 5.0% label noise (37 labels flipped)
2025-12-21 06:31:07,125 [INFO] Label distribution (after noise): 0=350, 1=399
2025-12-21 06:31:07,125 [INFO] Splitting data 80/20...
2025-12-21 06:31:07,127 [INFO] Training samples: 599
2025-12-21 06:31:07,128 [INFO] Test samples: 150
2025-12-21 06:31:07,128 [INFO] Scaling features...
2025-12-21 06:31:07,130 [INFO] Training Random Forest model...
2025-12-21 06:31:07,130 [INFO] Parameters: {'n_estimators': 150, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 5, 'max_features': 'sqrt', 'class_weight': 'balanced', 'bootstrap': True, 'oob_score': True, 'random_state': 42, 'n_jobs': 3}
2025-12-21 06:31:07,772 [INFO] Training complete!
2025-12-21 06:31:07,772 [INFO] Evaluating model...
2025-12-21 06:31:07,926 [INFO] ==================================================
2025-12-21 06:31:07,926 [INFO] METRICS:
2025-12-21 06:31:07,926 [INFO]   Accuracy:  0.9533
2025-12-21 06:31:07,926 [INFO]   Precision: 0.9398
2025-12-21 06:31:07,926 [INFO]   Recall:    0.9750
2025-12-21 06:31:07,926 [INFO]   F1 Score:  0.9571
2025-12-21 06:31:07,926 [INFO]   ROC AUC:   0.9292
2025-12-21 06:31:07,927 [INFO]   Confusion Matrix:
[[65  5]
 [ 2 78]]
2025-12-21 06:31:07,927 [INFO] ==================================================
2025-12-21 06:31:07,939 [INFO] Model saved to: /home/rana-workspace/ssh_guardian_v3.0/ml_models/random_forest_20251221_063107.pkl
2025-12-21 06:31:07,941 [ERROR] Failed to save model to database: 1054 (42S22): Unknown column 'feature_names' in 'field list'
2025-12-21 06:31:07,948 [ERROR] Failed to promote model: 1054 (42S22): Unknown column 'promoted_to_production_at' in 'field list'
2025-12-21 06:31:07,956 [INFO] ======================================================================
2025-12-21 06:31:07,956 [INFO] TRAINING COMPLETE!
2025-12-21 06:31:07,956 [INFO] ======================================================================
2025-12-21 06:31:07,956 [INFO] Model: random_forest_20251221_063107
2025-12-21 06:31:07,957 [INFO] Samples: 599
2025-12-21 06:31:07,957 [INFO] Accuracy: 0.9533
2025-12-21 06:31:07,957 [INFO] F1 Score: 0.9571
2025-12-21 06:31:07,957 [INFO] Status: production
2025-12-21 06:31:07,957 [INFO] ======================================================================
2025-12-21 06:32:10,227 [INFO] Starting chunked training from 2024-01-01 00:00:00 to 2025-12-21 06:32:10.227234
2025-12-21 06:32:11,848 [INFO] ======================================================================
2025-12-21 06:32:11,848 [INFO] SSH GUARDIAN v3.0 - CHUNKED ML TRAINING
2025-12-21 06:32:11,848 [INFO] ======================================================================
2025-12-21 06:32:13,717 [INFO] Total events in range: 749
2025-12-21 06:32:13,718 [INFO] Processing 1 chunks of 30,000 events each...
2025-12-21 06:32:13,718 [INFO] Using FeatureExtractor with 50 features
2025-12-21 06:32:13,718 [INFO] [Chunk 1/1] Loading events 0 to 30,000...
2025-12-21 06:32:14,076 [INFO] [Chunk 1/1] Processed. Total samples: 749
2025-12-21 06:32:14,077 [INFO] Converting to numpy arrays...
2025-12-21 06:32:14,173 [INFO] Feature matrix shape: (749, 50)
2025-12-21 06:32:14,173 [INFO] Label distribution (before noise): 0=333, 1=416
2025-12-21 06:32:14,174 [INFO] Injected 5.0% label noise (37 labels flipped)
2025-12-21 06:32:14,174 [INFO] Label distribution (after noise): 0=332, 1=417
2025-12-21 06:32:14,174 [INFO] Splitting data 80/20...
2025-12-21 06:32:14,177 [INFO] Training samples: 599
2025-12-21 06:32:14,177 [INFO] Test samples: 150
2025-12-21 06:32:14,177 [INFO] Scaling features...
2025-12-21 06:32:14,180 [INFO] Training Random Forest model...
2025-12-21 06:32:14,181 [INFO] Parameters: {'n_estimators': 150, 'max_depth': 20, 'min_samples_split': 10, 'min_samples_leaf': 5, 'max_features': 'sqrt', 'class_weight': 'balanced', 'bootstrap': True, 'oob_score': True, 'random_state': 42, 'n_jobs': 3}
2025-12-21 06:32:14,882 [INFO] Training complete!
2025-12-21 06:32:14,882 [INFO] Evaluating model...
2025-12-21 06:32:14,992 [INFO] ==================================================
2025-12-21 06:32:14,992 [INFO] METRICS:
2025-12-21 06:32:14,993 [INFO]   Accuracy:  0.9333
2025-12-21 06:32:14,993 [INFO]   Precision: 0.9405
2025-12-21 06:32:14,993 [INFO]   Recall:    0.9405
2025-12-21 06:32:14,994 [INFO]   F1 Score:  0.9405
2025-12-21 06:32:14,994 [INFO]   ROC AUC:   0.9324
2025-12-21 06:32:14,995 [INFO]   Confusion Matrix:
[[61  5]
 [ 5 79]]
2025-12-21 06:32:14,996 [INFO] ==================================================
2025-12-21 06:32:15,015 [INFO] Model saved to: /home/rana-workspace/ssh_guardian_v3.0/ml_models/random_forest_20251221_063214.pkl
2025-12-21 06:32:15,017 [ERROR] Failed to save model to database: 1054 (42S22): Unknown column 'training_data_start' in 'field list'
2025-12-21 06:32:15,029 [INFO] Model random_forest_20251221_063214 promoted to production!
2025-12-21 06:32:15,033 [INFO] ======================================================================
2025-12-21 06:32:15,034 [INFO] TRAINING COMPLETE!
2025-12-21 06:32:15,034 [INFO] ======================================================================
2025-12-21 06:32:15,035 [INFO] Model: random_forest_20251221_063214
2025-12-21 06:32:15,035 [INFO] Samples: 599
2025-12-21 06:32:15,035 [INFO] Accuracy: 0.9333
2025-12-21 06:32:15,036 [INFO] F1 Score: 0.9405
2025-12-21 06:32:15,036 [INFO] Status: production
2025-12-21 06:32:15,036 [INFO] ======================================================================
